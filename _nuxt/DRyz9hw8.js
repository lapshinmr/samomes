var ie=Object.defineProperty;var me=(_,t,l)=>t in _?ie(_,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):_[t]=l;var E=(_,t,l)=>me(_,typeof t!="symbol"?t+"":t,l);import{_ as ue}from"./BennhIYQ.js";import{_ as de}from"./DFy-W6Nl.js";import{a as he,_ as ce}from"./D0Eyi-NH.js";import{_ as pe}from"./Dc-nFeH9.js";import{_ as fe}from"./C9wVp3-b.js";import{t as j,f as I}from"./DHChNhVW.js";import{D,a as m}from"./BoIzNFIF.js";import{e as ge,k as ke,M as be,r as K,E as M,A as Ve,h as v,w as d,o as u,b as o,d as X,t as y,j as e,c as z,i as f,a as g,z as T,L as J,H as Ce,K as ve}from"./C4AY6iDY.js";import{u as _e}from"./Cku8uNeL.js";import{u as ye}from"./BIvOJ1vG.js";import{u as ze}from"./DknDYpsM.js";import{u as Te}from"./Bht1taiZ.js";import{u as we}from"./IiSMleoJ.js";import{u as Fe}from"./CY94b49y.js";import{u as xe}from"./Ci8V9Md_.js";import{R as Z}from"./ciCyplrD.js";import{M as Q}from"./BQGgX5ID.js";import{F as Pe}from"./CFPUExE7.js";import{D as A}from"./Ckubnz2N.js";import{a as G}from"./CusXBXJr.js";import{b as Ie,a as Re,V as We}from"./D_ojGsqK.js";import{V as Me}from"./_MrG4Qzc.js";import{a as Ge,V as $}from"./CbjFsO0T.js";import{V as He}from"./lxXI-Ipy.js";import{V as Se}from"./HLwzrep7.js";import{V as L}from"./CbywPFrM.js";import"./B931MWyl.js";import"./CY07sUq5.js";import"./C1PmHpO2.js";import"./D_YM2NF9.js";import"./BJEZURo1.js";import"./DFmCVkFv.js";import"./CEN1ZApb.js";import"./qzx_-4Xp.js";import"./CsOvkQMc.js";import"./CRWMzYl9.js";import"./C_viBdnf.js";import"./Dpja-O8o.js";import"./85aYgJ7U.js";import"./DxcjxDr2.js";import"./BBggtmFf.js";import"./D2vPiwbM.js";import"./Ch8e8etN.js";/* empty css        */class Ue{constructor(t,l){E(this,"doses");E(this,"tank");this.doses=t,this.tank=l}get isDoses(){return this.doses.length>0}get fertilizersHardness(){const t={gh:0,kh:0};return this.doses.forEach(l=>{var w,b;let c,a;if("hardness"in l.fertilizer&&((w=l.fertilizer.hardness)!=null&&w.gh||(b=l.fertilizer.hardness)!=null&&b.kh)){const h=l.fertilizer.hardness;c=h.gh*l.amount*h.volume/(h.amount*this.tank.waterChangeVolume),a=h.kh*l.amount*h.volume/(h.amount*this.tank.waterChangeVolume)}else c=Z.countGh(l.fertilizer.concentration,l.amount,this.tank.waterChangeVolume)??0,a=Z.countKh(l.fertilizer.concentration,l.amount,this.tank.waterChangeVolume)??0,l.fertilizer.isLiquid&&(c/=Q,a/=Q);t.gh+=c,t.kh+=a}),t}countWaterChangeGh(t,l){return t*(1-l/100)+this.fertilizersHardness.gh}countTotalGh(t,l,c){const b=l*(1-c/100)*this.tank.waterChangePercent/100,h=t*(1-this.tank.waterChangePercent/100),F=this.fertilizersHardness.gh*this.tank.waterChangePercent/100;return h+b+F}countWaterChangeKh(t,l){return t*(1-l/100)+this.fertilizersHardness.kh}countTotalKh(t,l,c){const b=l*(1-c/100)*this.tank.waterChangePercent/100,h=t*(1-this.tank.waterChangePercent/100),F=this.fertilizersHardness.kh*this.tank.waterChangePercent/100;return h+b+F}}const De={key:0},Ke={class:"mt-2 mt-sm-6"},Ae={class:"d-flex flex-column flex-md-row"},Le={key:0},Ne={class:"text-subtitle-1"},Ee={class:"d-flex flex-column flex-sm-row align-sm-center"},Xe={key:0},$e={class:"text-headline mt-8"},Be={class:"d-flex"},qe={class:"d-flex"},Oe={key:0,class:"mt-8"},je={class:"d-flex flex-column flex-sm-row align-md-center mb-8"},Je={key:0,class:"mt-8"},Ze={class:"text-subtitle-1 mb-2"},Qe={class:"d-flex"},Ye={class:"d-flex"},$t=ge({name:"HardnessPage",__name:"index",setup(_){const{t}=ke(),{required:l}=_e(),{smAndUp:c}=be(),a=ye(),w=ze(),{fertilizerRecipes:b}=Te(),{fertilizers:h}=we(),{remineralRecipes:F}=Fe(),Y=xe(),ee=w.tankModels.map(s=>s.toJson()),R=K(0),W=K(0),x=K(0),P=K(0),H=s=>!Number.isNaN(+s)&&+s!=1/0||"Проверьте вводимые параметры",S=M(()=>new Ue(a.doseModels,a.tank)),U=M({get(){return a.isDefaultFertilizers},set(s){a.setDefaultFertilizers(s),Y.show(s?"Фирменные удобрения добавлены в список":"Фирменные удобрения удалены из списка")}}),te=M(()=>{let s=[];if(U.value){const n=b.map(V=>V.name),N=h.map(V=>V.name),k=F.map(V=>V.name);s=Pe.filter(V=>![...n,...N,...k].includes(V.name))}return[...b.map(n=>new A({fertilizer:n,fertilizerType:D.fertilizerRecipe,daysTotal:1})),...h.map(n=>new A({fertilizer:n,fertilizerType:D.fertilizer,daysTotal:1})),...F.map(n=>new A({fertilizer:n,fertilizerType:D.remineralRecipe,daysTotal:1})),...s.map(n=>new A({fertilizer:n,fertilizerType:D.fertilizer,daysTotal:1}))]}),p=M({get(){return a.remineralizationType},set(s){a.setRemineralizationType(s),a.setDoses([]),R.value=0,W.value=0,x.value=0,P.value=0}}),C=M({get(){return a.isTests},set(s){a.setIsTests(s)}});function se(s){if(typeof s=="number"){a.setTank({name:s.toString(),volume:s});return}else if(typeof s=="string"||s===null)return;a.setTank({name:s.name,volume:s.volumeTotal,waterChangeVolume:s.waterChangeVolume||0,waterChangePercent:s.waterChangePercent||0})}function ae(s){s.length>a.doseModels.length&&typeof[...s].pop()=="string"||a.setDoses(s)}function B(s){s<0||s<=100&&(a.setWaterChangePercent(s),a.setWaterChangeVolume(I(a.tank.volume*s/100,3)))}function q(s){s<0||s<=a.tank.volume&&(a.setWaterChangeVolume(s),a.setWaterChangePercent(I(s/a.tank.volume*100,3)))}function O(s){s<0||s<=100&&a.setOsmosisChangePercent(+s)}function ne(){a.reset()}return Ve({title:t("meta.hardness.title"),description:t("meta.hardness.description"),keywords:t("meta.hardness.keywords")}),(s,n)=>{const N=ue,k=de,V=ce,le=pe,oe=fe;return u(),v(Ie,{class:"mb-10"},{default:d(()=>[o(Re,null,{default:d(()=>[o(N,null,{button:d(()=>[o(Me,{color:"primary",onClick:ne},{default:d(()=>[X(y(e(t)("buttons.reset")),1)]),_:1})]),default:d(()=>[X(y(e(t)("hardness.title"))+" ",1)]),_:1}),o(We,{cols:"12",sm:"10",md:"8","offset-sm":"1","offset-md":"2"},{default:d(()=>[o(le,null,{default:d(()=>[o(he,{modelValue:e(a).tank,"onUpdate:modelValue":[n[0]||(n[0]=i=>e(a).tank=i),se],modelModifiers:{number:!0},items:e(ee),"item-title":"name",variant:"underlined",label:e(t)("hardness.tankInputLabel"),hint:e(t)("hardness.tankInputHint"),"persistent-hint":"","hide-selected":"",rules:[e(l)],class:"mb-4"},null,8,["modelValue","items","label","hint","rules"]),o(G,null,{default:d(()=>{var i;return[(i=e(a).tank)!=null&&i.volume?(u(),z("div",De,[g("div",Ke,y(e(t)("hardness.waterChangeType")),1),g("div",Ae,[o(Ge,{modelValue:e(p),"onUpdate:modelValue":n[1]||(n[1]=r=>T(p)?p.value=r:null),class:"my-2 ml-n2",color:"primary","hide-details":"auto",inline:e(c)},{default:d(()=>[o($,{label:e(t)("hardness.osmosisAndRem"),value:e(m).REM},null,8,["label","value"]),o($,{label:e(t)("hardness.osmosisAndTap"),value:e(m).TAP,class:"mt-1 mt-sm-0"},null,8,["label","value"]),o($,{label:e(t)("hardness.otherType"),value:e(m).MIX,class:"mt-1 mt-sm-0"},null,8,["label","value"])]),_:1},8,["modelValue","inline"]),o(He,{modelValue:e(C),"onUpdate:modelValue":n[2]||(n[2]=r=>T(C)?C.value=r:null),color:"primary",label:e(t)("hardness.isTests")},null,8,["modelValue","label"])])])):f("",!0)]}),_:1}),o(G,null,{default:d(()=>{var i;return[(i=e(a).tank)!=null&&i.volume&&e(p)!==null?(u(),z("div",Le,[g("div",Ne,y(e(t)("hardness.chooseVolumeHint")),1),g("div",Ee,[o(k,{"model-value":e(a).tank.waterChangeVolume,label:e(t)("hardness.volumeInputLabel"),hint:e(t)("hardness.volumeInputHint"),"persistent-hint":"",suffix:e(t)("units.l"),class:"pt-0 mt-0","append-icon":"mdi-arrow-up-bold-circle-outline","onUpdate:modelValue":q,"onClick:append":n[3]||(n[3]=r=>q(e(a).tank.volume))},null,8,["model-value","label","hint","suffix"]),o(k,{"model-value":e(a).tank.waterChangePercent,label:e(t)("hardness.changeInputLabel"),hint:e(t)("hardness.changeInputHint"),"persistent-hint":"",suffix:"%",class:"pt-0 mt-0 ml-sm-3","append-icon":"mdi-arrow-up-bold-circle-outline","onUpdate:modelValue":B,"onClick:append":n[4]||(n[4]=r=>B(100))},null,8,["model-value","label","hint"]),[e(m).TAP,e(m).MIX].includes(e(p))?(u(),v(k,{key:0,"model-value":e(a).osmosisChangePercent,label:e(t)("hardness.osmosisPercentLabel"),hint:e(t)("hardness.osmosisPercentHint",{osmosisChangeVolume:("toFixed"in s?s.toFixed:e(j))(e(a).osmosisChangeVolume,1),tapChangeVolume:("toFixed"in s?s.toFixed:e(j))(e(a).tapChangeVolume,1)}),"persistent-hint":"",class:"mt-0 pt-0 ml-sm-3","single-line":"",suffix:"%","append-icon":"mdi-arrow-up-bold-circle-outline","onUpdate:modelValue":O,"onClick:append":n[5]||(n[5]=r=>O(100))},null,8,["model-value","label","hint"])):f("",!0)]),o(G,null,{default:d(()=>[e(C)||[e(m).TAP,e(m).MIX].includes(e(p))?(u(),z("div",Xe,[g("div",$e,y(e(t)("hardness.initHardness")),1),g("div",Be,[[e(m).TAP,e(m).MIX].includes(e(p))?(u(),v(k,{key:0,modelValue:e(x),"onUpdate:modelValue":n[6]||(n[6]=r=>T(x)?x.value=r:null),label:e(t)("hardness.tapWaterGh"),suffix:"Gh","hide-details":"auto"},null,8,["modelValue","label"])):f("",!0),e(C)?(u(),v(k,{key:1,modelValue:e(R),"onUpdate:modelValue":n[7]||(n[7]=r=>T(R)?R.value=r:null),label:e(t)("hardness.tankWaterGh"),suffix:"Gh","hide-details":"auto",class:J({"ml-3":[e(m).TAP,e(m).MIX].includes(e(p))})},null,8,["modelValue","label","class"])):f("",!0)]),g("div",qe,[[e(m).TAP,e(m).MIX].includes(e(p))?(u(),v(k,{key:0,modelValue:e(P),"onUpdate:modelValue":n[8]||(n[8]=r=>T(P)?P.value=r:null),label:e(t)("hardness.tapWaterKh"),suffix:"Kh","hide-details":"auto"},null,8,["modelValue","label"])):f("",!0),e(C)?(u(),v(k,{key:1,modelValue:e(W),"onUpdate:modelValue":n[9]||(n[9]=r=>T(W)?W.value=r:null),label:e(t)("hardness.tankWaterKh"),suffix:"Kh","hide-details":"auto",class:J({"ml-3":[e(m).TAP,e(m).MIX].includes(e(p))})},null,8,["modelValue","label","class"])):f("",!0)])])):f("",!0)]),_:1})])):f("",!0)]}),_:1}),o(G,null,{default:d(()=>{var i;return[(i=e(a).tank)!=null&&i.volume&&[e(m).REM,e(m).MIX].includes(e(p))?(u(),z("div",Oe,[g("div",je,[o(V,{"model-value":e(a).doseModels,items:e(te),variant:"underlined",label:e(t)("dosing.fertilizersInputLabel"),hint:e(t)("dosing.fertilizersInputHint"),"item-title":"fertilizer.name","persistent-hint":"",multiple:"",chips:"","closable-chips":"",class:"mb-4","onUpdate:modelValue":ae},null,8,["model-value","items","label","hint"]),o(Se,{modelValue:e(U),"onUpdate:modelValue":n[10]||(n[10]=r=>T(U)?U.value=r:null),color:"primary",label:e(t)("dosing.switch"),class:"ml-md-4 flex-shrink-0"},null,8,["modelValue","label"])])])):f("",!0)]}),_:1}),(u(!0),z(Ce,null,ve(e(a).doseModels,(i,r)=>(u(),z("div",{key:`dose_${r}`},[o(k,{"model-value":i.amount,label:i.fertilizer.name,suffix:i.fertilizer.isLiquid?e(t)("units.ml"):e(t)("units.g"),"hide-details":"auto",class:"mb-2","onUpdate:modelValue":re=>e(a).updateAmountDay(re,r)},null,8,["model-value","label","suffix","onUpdate:modelValue"])]))),128)),o(G,null,{default:d(()=>{var i;return[(i=e(a).tank)!=null&&i.volume&&e(p)!==null?(u(),z("div",Je,[g("div",Ze,y(e(t)("hardness.resultHardness")),1),g("div",null,[g("div",Qe,[o(L,{"model-value":("format"in s?s.format:e(I))(e(S).countWaterChangeGh(e(x),e(a).osmosisChangePercent)),label:e(t)("hardness.result.changeWaterGh"),suffix:"Gh","hide-details":"auto",readonly:"",variant:"outlined","persistent-hint":"",class:"mb-3",rules:[H]},null,8,["model-value","label","rules"]),e(C)?(u(),v(L,{key:0,"model-value":("format"in s?s.format:e(I))(e(S).countTotalGh(e(R),e(x),e(a).osmosisChangePercent)),label:e(t)("hardness.result.tankWaterGh"),suffix:"Gh","hide-details":"auto",readonly:"",variant:"outlined","persistent-hint":"",class:"mb-3 ml-3",rules:[H]},null,8,["model-value","label","rules"])):f("",!0)]),g("div",Ye,[o(L,{"model-value":("format"in s?s.format:e(I))(e(S).countWaterChangeKh(e(P),e(a).osmosisChangePercent)),label:e(t)("hardness.result.changeWaterKh"),suffix:"Kh","hide-details":"auto",readonly:"",variant:"outlined","persistent-hint":"",rules:[H]},null,8,["model-value","label","rules"]),e(C)?(u(),v(L,{key:0,"model-value":("format"in s?s.format:e(I))(e(S).countTotalKh(e(W),e(P),e(a).osmosisChangePercent)),label:e(t)("hardness.result.tankWaterKh"),suffix:"Kh","hide-details":"auto",readonly:"",variant:"outlined","persistent-hint":"",class:"ml-3",rules:[H]},null,8,["model-value","label","rules"])):f("",!0)])])])):f("",!0)]}),_:1})]),_:1})]),_:1}),o(oe,null,{default:d(()=>[X(y(e(t)("hardness.hints.p1")),1)]),_:1})]),_:1})]),_:1})}}});export{$t as default};
