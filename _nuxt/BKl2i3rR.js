import{_ as de}from"./DE-kfHKG.js";import{_ as me}from"./BKGzhLFO.js";import{V as pe,_ as fe}from"./B1xm3xRq.js";import{_ as ce}from"./DAF1G55o.js";import{_ as q}from"./BUJFLcPK.js";import{F as he}from"./CFPUExE7.js";import{e as ve,k as ge,H as Ve,G as _e,r as I,E as ze,F as m,z as B,f as be,B as xe,h as c,w as n,o as p,b as s,j as e,c as N,I as O,d,t as o,a as V,i as _,A as M,L as Ie,J as Ee,K as ke,_ as ye}from"./DFG5sAfX.js";import{u as Fe}from"./BIXjO7P4.js";import{u as Re}from"./CoO_-vj9.js";import{u as we}from"./qdqMa2Gg.js";import{u as Pe}from"./CIqVXe_f.js";import{F as Ae}from"./CYc57goH.js";import{A as Ce}from"./BXpKWP0_.js";import{t as Ne}from"./BBggtmFf.js";import{u as Oe,V as Le}from"./B2ugxKM-.js";import{a as K}from"./2eSb8hgA.js";import{b as Se,a as D,V as E}from"./BrK6A4ac.js";import{V as W}from"./BAuGkXQz.js";import{a as $,V as k}from"./Dc-TPRor.js";import{V as Ue}from"./DCUc0X6q.js";import{V as L}from"./b6rgidj0.js";import"./6sDFnY8D.js";import"./Bapplkw-.js";import"./B931MWyl.js";import"./CGotk2uM.js";import"./BX9MECSf.js";import"./DTX0tUqu.js";import"./BkVHWGhG.js";import"./CVrSEdTP.js";import"./nlrI5vAl.js";import"./CQay1gPF.js";import"./CbQAqJWO.js";import"./BQK4NqOt.js";import"./TA95ghgx.js";import"./DjjMRDDF.js";import"./BL0FC99F.js";import"./FI_hX0un.js";import"./BFTaGu8H.js";import"./BRCeRKMw.js";/* empty css        */const Te={class:"mb-4"},He={class:"text-body-2 text-grey-darken-1"},qe={class:"d-flex mt-10"},Be=ve({__name:"[id]",setup(Me){const{t:l}=ge(),z=Ve(),y=_e(),{appRoutes:h}=Fe(),{required:F}=Re(),b=we(),v=Pe(),R=I(null),u=I([]),f=I(null),g=I(!1),i=ze(new Ae({name:"",description:"",ions:{},isLiquid:!0,isPercent:!0,updatedAt:"",hardness:{gh:null,kh:null,amount:null,volume:null}})),G=m(()=>!!u.value.find(({ion:t})=>["N","NO3"].includes(t))),J=m(()=>!!u.value.find(({ion:t})=>["P","PO4","P2O5"].includes(t))),Z=m(()=>!!u.value.find(({ion:t})=>["K","K2O"].includes(t))),j=m(()=>!!u.value.find(({ion:t})=>["Ca","CaO"].includes(t))),Q=m(()=>!!u.value.find(({ion:t})=>["Mg","MgO"].includes(t))),X=m(()=>{const t=[];for(const a of Ce)G.value&&["N","NO3"].includes(a)||J.value&&["P","PO4","P2O5"].includes(a)||Z.value&&["K","K2O"].includes(a)||j.value&&["Ca","CaO"].includes(a)||Q.value&&["Mg","MgO"].includes(a)||t.push({ion:a,conc:null});return t});function S(t){i.name=t.name,i.description=t.description,i.isPercent=t.isPercent,i.isLiquid=t.isLiquid,i.updatedAt=t.updatedAt,i.hardness={...t.hardness},t.hardness&&(g.value=!0),Ne(t.ions).forEach(([a,A])=>{u.value.push({ion:a,conc:A})})}function U(){i.name="",i.description="",i.isPercent=!1,i.updatedAt=void 0,u.value=[],i.ions={}}B(f,t=>{if(t===null||typeof t=="string"){U();return}U(),S(t)}),B(u,()=>{u.value.forEach(({ion:t,conc:a})=>{i.ions[t]=a})},{deep:!0});const{checkName:Y}=Oe(),w=m(()=>y.params.id==="create"),T=m(()=>y.params.id!=="create"),P=m(()=>+y.params.id),ee=m(()=>{var t;return f.value!==null&&typeof f.value!="string"&&((t=f.value)==null?void 0:t.isPercent)!==i.isPercent}),te=m(()=>Y(i.name)&&!T.value),le=()=>!te.value||l("fertilizers.page.message.nameExists");be(async()=>{if(w.value)return;const t={...b.fertilizers[P.value]};if(!t){await z.push(h.value.fertilizers.path);return}S(t)});function ie(t){t.length>u.value.length&&typeof[...t].pop()=="string"||(u.value=t)}async function ae(){const{valid:t}=await R.value.validate();if(!t){v.showWarning(l("common.isFormErrors"));return}b.addFertilizer(i.toJson()),v.show(l("fertilizers.page.message.fertilizerAdded")),await z.push(h.value.fertilizers.path)}async function se(){const{valid:t}=await R.value.validate();if(!t){v.showWarning(l("common.isFormErrors"));return}b.editFertilizer({index:P.value,fertilizer:i.toJson()}),v.show(l("fertilizers.page.message.fertilizerEdited")),await z.push(h.value.fertilizers.path)}async function re(){b.removeFertilizer(P.value),v.show(l("fertilizers.page.message.fertilizerRemoved")),await z.push(h.value.fertilizers.path)}return xe({title:l("meta.fertilizer.title")}),(t,a)=>{const A=de,ne=me,C=fe,H=ce,oe=q,x=q;return p(),c(Se,{class:"mb-12"},{default:n(()=>[s(D,null,{default:n(()=>[s(A,{path:e(h).fertilizers.path},null,8,["path"]),s(ne,null,{default:n(()=>[e(w)?(p(),N(O,{key:0},[d(o(e(l)("fertilizers.page.titleNew")),1)],64)):(p(),N(O,{key:1},[d(o(e(i).name),1)],64))]),_:1}),s(E,{cols:"12",md:"8","offset-md":"2"},{default:n(()=>[s(pe,{ref_key:"fertilizerFormRef",ref:R},{default:n(()=>[V("div",null,[d(o(e(l)("fertilizers.page.formDescription"))+" ",1),s(C,{class:"mb-3 mt-10"},{default:n(()=>[d(o(e(l)("common.or")),1)]),_:1})]),s(H,{modelValue:e(f),"onUpdate:modelValue":a[0]||(a[0]=r=>M(f)?f.value=r:null),items:"FERTILIZERS_SORTED"in t?t.FERTILIZERS_SORTED:e(he),variant:"underlined",label:e(l)("fertilizers.page.fertilizers"),hint:e(l)("fertilizers.page.fertilizersHint"),"persistent-hint":"","item-title":"name","hide-details":"auto"},null,8,["modelValue","items","label","hint"]),e(i).updatedAt?(p(),c(W,{key:0,type:"success",class:"mt-2"},{default:n(()=>[d(o(e(l)("fertilizers.page.alertInfo"))+" "+o(e(i).updatedAt),1)]),_:1})):_("",!0),s(C,{class:"mt-10 mb-3"},{default:n(()=>[d(o(e(l)("fertilizers.card.composition")),1)]),_:1}),s($,{modelValue:e(i).isLiquid,"onUpdate:modelValue":a[1]||(a[1]=r=>e(i).isLiquid=r),inline:"",color:"primary",class:"mt-3 ml-n2","hide-details":"auto"},{default:n(()=>[s(k,{label:e(l)("common.liquid"),value:!0},null,8,["label"]),s(k,{label:e(l)("common.dry"),value:!1},null,8,["label"])]),_:1},8,["modelValue"]),s(K,null,{default:n(()=>[e(i).isLiquid?(p(),c($,{key:0,modelValue:e(i).isPercent,"onUpdate:modelValue":a[2]||(a[2]=r=>e(i).isPercent=r),inline:"",color:"primary",class:"mt-3 ml-n2","hide-details":"auto"},{default:n(()=>[s(k,{label:e(l)("units.g/l"),value:!1},null,8,["label"]),s(k,{label:"%",value:!0})]),_:1},8,["modelValue"])):_("",!0)]),_:1}),e(ee)?(p(),c(W,{key:1,type:"error",class:"mt-4"},{default:n(()=>[d(o(e(l)("fertilizers.page.alertWarning")),1)]),_:1})):_("",!0),s(H,{"model-value":e(u),items:e(X),"item-title":"ion",variant:"underlined",label:e(l)("fertilizers.page.ionsInput"),hint:e(l)("fertilizers.page.ionsInputHint"),"persistent-hint":"","hide-details":"auto",multiple:"",chips:"","closable-chips":"",rules:[e(F)],class:"mb-4","onUpdate:modelValue":ie},null,8,["model-value","items","label","hint","rules"]),(p(!0),N(O,null,Ie(e(u),r=>(p(),c(oe,{key:r.ion,modelValue:r.conc,"onUpdate:modelValue":ue=>r.conc=ue,label:r.ion,suffix:e(i).isPercent?"%":e(l)("units.g/l"),variant:"underlined","persistent-placeholder":"",placeholder:"0","hide-details":"auto",rules:[e(F)],class:"mb-2"},null,8,["modelValue","onUpdate:modelValue","label","suffix","rules"]))),128)),s(C,{modelValue:e(g),"onUpdate:modelValue":a[3]||(a[3]=r=>M(g)?g.value=r:null),button:"",class:"mt-10 mb-3"},{default:n(()=>[d(o(e(l)("fertilizers.page.remineral")),1)]),_:1},8,["modelValue"]),s(K,null,{default:n(()=>[e(g)?(p(),c(D,{key:0,class:"d-flex flex-wrap mb-2"},{default:n(()=>[s(E,{cols:"12"},{default:n(()=>[V("div",Te,o(e(l)("fertilizers.page.remineralInstruction")),1),V("div",He,[d(o(e(l)("fertilizers.page.remineralExample1")),1),a[10]||(a[10]=V("br",null,null,-1)),d(" "+o(e(l)("fertilizers.page.remineralExample2")),1)])]),_:1}),s(E,{cols:"6"},{default:n(()=>[s(x,{modelValue:e(i).hardness.gh,"onUpdate:modelValue":a[4]||(a[4]=r=>e(i).hardness.gh=r),label:e(l)("fertilizers.page.ghInput"),suffix:"Gh",hint:e(l)("fertilizers.page.ghInputHint"),"hide-details":"auto"},null,8,["modelValue","label","hint"]),s(x,{modelValue:e(i).hardness.amount,"onUpdate:modelValue":a[5]||(a[5]=r=>e(i).hardness.amount=r),label:e(l)("fertilizers.page.remineralAmountInput"),hint:e(l)("fertilizers.page.remineralAmountInputHint"),suffix:e(i).isLiquid?e(l)("units.ml"):e(l)("units.g"),"hide-details":"auto"},null,8,["modelValue","label","hint","suffix"])]),_:1}),s(E,{cols:"6"},{default:n(()=>[s(x,{modelValue:e(i).hardness.kh,"onUpdate:modelValue":a[6]||(a[6]=r=>e(i).hardness.kh=r),label:e(l)("fertilizers.page.khInput"),suffix:"Kh",hint:e(l)("fertilizers.page.khInputHint"),"hide-details":"auto"},null,8,["modelValue","label","hint"]),s(x,{modelValue:e(i).hardness.volume,"onUpdate:modelValue":a[7]||(a[7]=r=>e(i).hardness.volume=r),label:e(l)("fertilizers.page.remineralVolumeInput"),hint:e(l)("fertilizers.page.remineralVolumeInputHint"),suffix:e(l)("units.l"),"hide-details":"auto"},null,8,["modelValue","label","hint","suffix"])]),_:1})]),_:1})):_("",!0)]),_:1}),s(Ue,{modelValue:e(i).name,"onUpdate:modelValue":a[8]||(a[8]=r=>e(i).name=r),variant:"underlined",label:e(l)("fertilizers.page.name"),hint:e(l)("fertilizers.page.nameHint"),"hide-details":"auto",rules:[e(F),le],class:"mb-2 mt-8"},null,8,["modelValue","label","hint","rules"]),s(Le,{modelValue:e(i).description,"onUpdate:modelValue":a[9]||(a[9]=r=>e(i).description=r),variant:"underlined",label:e(l)("fertilizers.page.description"),hint:e(l)("fertilizers.page.descriptionHint"),"hide-details":"auto","auto-grow":"",rows:"1"},null,8,["modelValue","label","hint"]),V("div",qe,[e(T)?(p(),c(L,{key:0,color:"error",onClick:re},{default:n(()=>[d(o(e(l)("buttons.remove")),1)]),_:1})):_("",!0),s(L,{class:"ml-auto",to:e(h).fertilizers.path},{default:n(()=>[d(o(e(l)("buttons.cancel")),1)]),_:1},8,["to"]),s(L,Ee({color:"primary",class:"ml-2"},ke(e(w)?{click:ae}:{click:se})),{default:n(()=>[d(o(e(l)("buttons.save")),1)]),_:1},16)])]),_:1},512)]),_:1})]),_:1})]),_:1})}}}),wt=ye(Be,[["__scopeId","data-v-60e3301a"]]);export{wt as default};
