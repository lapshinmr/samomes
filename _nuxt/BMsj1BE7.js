import{_ as Q}from"./CcHEQ_hp.js";import{_ as X,a as Y,b as Z}from"./Djo_BLZO.js";import{f as ee,b as E,a as te}from"./DHChNhVW.js";import{V as z,f as se}from"./CW3zH-KM.js";import{e as F,E as h,h as g,o as l,I as P,j as n,w as t,a as m,c as p,i as V,t as f,k as N,G,r as ae,f as oe,b as o,d as i,z as ne,K as x,H as D,A as le}from"./DooifDUh.js";import{A as re,F as ue}from"./BoIzNFIF.js";import{u as ie}from"./BNIurP-x.js";import{u as J}from"./BZXKcgwa.js";import{u as K}from"./CC3oMuXH.js";import{b as de}from"./BBggtmFf.js";import{V as me,a as ce,d as fe,b as pe,c as _e}from"./DVc9NPUo.js";import{V as he,a as ge}from"./DSttDyE1.js";import{a as L,V as M,b as ye}from"./IJfdJ5eC.js";import{_ as ve}from"./CdcB-AJD.js";import{_ as ke}from"./DFlcUXpa.js";import"./BiowDoc4.js";import"./B3b8EGS5.js";import"./B2b76GT0.js";import"./B931MWyl.js";import"./BKA_xJF-.js";import"./kRSO-CDq.js";import"./Ckubnz2N.js";import"./DxcjxDr2.js";import"./BQGgX5ID.js";import"./Ch8e8etN.js";import"./D2vPiwbM.js";import"./ciCyplrD.js";import"./DYmkVVx6.js";import"./V-caTe66.js";import"./Dono62s_.js";import"./BaLlFs20.js";/* empty css        */import"./DIWpmZ0I.js";const be={class:"d-flex justify-space-between align-center w-100"},Ce={class:"text-truncate text-subtitle-2 text-sm-h6 font-weight-regular mx-2"},De={class:"text-uppercase",style:{overflow:"hidden","text-overflow":"ellipsis"}},Ve={key:0,class:"text-h6 text-sm-h5 ml-2"},we=F({name:"ScheduleButton",__name:"ScheduleButton",props:{fertilizerName:{},amount:{},status:{}},setup(w){const v=w,k=h(()=>["primary","primary","grey"][v.status]),d=h(()=>["outlined","elevated","outlined"][v.status]);return(r,S)=>(l(),g(z,P(r.$attrs,{block:"",size:"x-large",tile:"",color:n(k),variant:n(d),class:"mb-2 px-3",disabled:!r.amount}),{default:t(()=>[m("div",be,[m("div",Ce,[m("div",De,f(r.fertilizerName),1)]),r.amount>0?(l(),p("div",Ve,f(("format"in r?r.format:n(ee))(r.amount)),1)):V("",!0)])]),_:1},16,["color","variant","disabled"]))}}),Se={class:"no-break"},$e={class:"d-flex flex-column text-h4 text-center mb-4"},ze={style:{"text-transform":"capitalize"}},xe=F({name:"ScheduleCard",__name:"ScheduleCard",props:{schedule:{},scheduleIndex:{}},setup(w){const{t:v}=N(),k=G(),d=ie(),r=J(),{appRoutes:S}=K(),u=w,s=ae(0),R=h(()=>{const e=new Date(u.schedule.startDate);return E(e)}),T=h(()=>{const e=new Date(u.schedule.startDate),a=new Date(e.setDate(e.getDate()+u.schedule.dosing.daysTotal-1));return E(a)}),y=h(()=>u.schedule.dosing.daysTotal),A=h(()=>(s.value+1)/y.value*100),B=h(()=>{const[e,...a]=JSON.parse(JSON.stringify(u.schedule.days));return e.fertilizers={...u.schedule.waterChangeDay.fertilizers,...e.fertilizers},[e,...a]});oe(()=>{s.value=I()});function I(){const e=B.value.findIndex(a=>de(a.fertilizers).some(_=>_.status===re.ACTIVE&&_.amount));return e===-1?y.value-1:e}function W(e,a,_){r.toggleDay(e,a,_)}function O(e,a){r.toggleWaterChangeDay(e,a)}function $(){s.value>=1&&(s.value-=1)}function H(){s.value<y.value-1&&(s.value+=1)}async function U(){d.setDaysTotal(u.schedule.dosing.daysTotal),d.setFertilizersRegime(u.schedule.dosing.fertilizersRegime),d.setTank(u.schedule.dosing.tank),d.setDoses(u.schedule.dosing.doses),await k.push(`${S.value.dosing.path}?schedule=${u.scheduleIndex}`)}return(e,a)=>{const _=we;return l(),g(me,P(e.$attrs,{elevation:"4"}),{default:t(()=>[o(ce,{class:"d-flex justify-space-between align-start font-weight-regular flex-nowrap"},{default:t(()=>[m("div",Se,f(e.schedule.dosing.tank.name),1)]),_:1}),o(fe,{class:"mt-n3"},{default:t(()=>[i(f(n(R))+" - "+f(n(T)),1)]),_:1}),o(pe,{class:"mt-6 mb-4"},{default:t(()=>[o(he,{modelValue:n(s),"onUpdate:modelValue":a[0]||(a[0]=b=>ne(s)?s.value=b:null)},{default:t(()=>[(l(!0),p(D,null,x(e.schedule.days,(b,j)=>(l(),g(ge,{key:`${j}-content`},{default:t(()=>[o(L,null,{default:t(()=>[o(M,{cols:"12",sm:"10","offset-sm":"1"},{default:t(()=>[m("div",$e,[m("div",null,[m("span",ze,f(("getWeekday"in e?e.getWeekday:n(te))(b.date)),1),a[1]||(a[1]=i(", ")),m("span",null,f(("formatDate"in e?e.formatDate:n(E))(b.date)),1)])]),j===0?(l(!0),p(D,{key:0},x(e.schedule.waterChangeDay.fertilizers,(C,c)=>(l(),p("div",{key:`water_change_${c}`},[o(_,{"fertilizer-name":c,amount:C.amount,status:C.status,onClick:q=>O(e.scheduleIndex,c)},{default:t(()=>[i(f(c),1)]),_:2},1032,["fertilizer-name","amount","status","onClick"])]))),128)):V("",!0),(l(!0),p(D,null,x(b.fertilizers,(C,c)=>(l(),p("div",{key:`water_change_${c}`},[o(_,{"fertilizer-name":c,amount:C.amount,status:C.status,onClick:q=>W(e.scheduleIndex,j,c)},{default:t(()=>[i(f(c),1)]),_:2},1032,["fertilizer-name","amount","status","onClick"])]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1}),o(_e,null,{default:t(()=>[e.schedule.dosing.fertilizersRegime!==("FertilizersRegime"in e?e.FertilizersRegime:n(ue)).ONCE_A_WEEK?(l(),p(D,{key:0},[o(z,{disabled:n(s)===0,class:"ml-auto",onClick:$},{default:t(()=>a[2]||(a[2]=[i(" Назад ")])),_:1},8,["disabled"]),o(z,{disabled:n(s)===n(y)-1,class:"ml-0 ml-sm-3",onClick:H},{default:t(()=>a[3]||(a[3]=[i(" Далее ")])),_:1},8,["disabled"])],64)):V("",!0),o(z,{class:"ml-0 ml-sm-3",onClick:U},{default:t(()=>a[4]||(a[4]=[i(" Открыть ")])),_:1})]),_:1}),o(se,{color:"primary","model-value":n(A)},null,8,["model-value"])]),_:1},16)}}}),it=F({__name:"index",setup(w){const v=G(),{appRoutes:k}=K(),{t:d}=N(),r=J();function S(){return v.push(`${k.value.dosing.path}`)}return le({title:d("meta.schedules.title"),description:d("meta.schedules.description"),keywords:d("meta.schedules.keywords")}),(u,s)=>{const R=Q,T=X,y=Y,A=xe,B=ve,I=ke,W=Z;return l(),g(ye,{"min-height":"100%",class:"mb-12 position-relative"},{default:t(()=>[o(L,null,{default:t(()=>[o(R,null,{default:t(()=>s[0]||(s[0]=[i(" Расписание ")])),_:1}),o(I,null,{default:t(()=>[n(r).schedules.length===0?(l(),g(T,{key:0},{default:t(()=>s[1]||(s[1]=[i(" У вас еще нет ни одного расписания ")])),_:1})):V("",!0),n(r).schedules.length===0?(l(),g(y,{key:1,class:"mb-16"},{default:t(()=>s[2]||(s[2]=[i(" Начните с нажатия на кнопку «Добавить», чтобы добавить новое расписание. ")])),_:1})):V("",!0),o(M,{sm:"10",md:"8","offset-sm":"1","offset-md":"2"},{default:t(()=>[(l(!0),p(D,null,x(n(r).schedules,(O,$)=>(l(),g(A,{key:$,schedule:O,"schedule-index":$,class:"mb-10"},null,8,["schedule","schedule-index"]))),128))]),_:1}),o(B,null,{default:t(()=>s[3]||(s[3]=[m("p",{class:"mb-2"}," Если у вас несколько бутылок с удобрениями, дозировки каждого удобрения отличаются друг от друга, да еще и несколько аквариумов, то можно довольно легко ошибиться с внесением удобрений. ",-1),m("p",{class:"mb-2"}," Удобный виджет поможет вам составить расписание на всю неделю и следить за тем, какие удобрения нужно внести. ",-1)])),_:1})]),_:1})]),_:1}),o(W,{action:S},{default:t(()=>s[4]||(s[4]=[i(" Добавить расписание ")])),_:1})]),_:1})}}});export{it as default};
