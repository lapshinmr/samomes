import{_ as ee}from"./DIra7s3Q.js";import{_ as te,a as se,b as ae}from"./C8ysMnRU.js";import{f as oe,b as O,a as ne}from"./DHChNhVW.js";import{V as T,f as le}from"./BFeFc3tU.js";import{e as P,E as v,h as b,o as r,I as J,j as e,w as s,a as m,c as g,i as S,t as n,k as M,G as N,r as re,f as ue,b as a,d as c,z as ie,L as A,H as w,A as de}from"./Dt_hY5Oj.js";import{u as ce}from"./B8EHSZKT.js";import{u as H}from"./EFSP32lW.js";import{u as U}from"./BXcduvnD.js";import{b as F}from"./BBggtmFf.js";import{A as G}from"./BoIzNFIF.js";import{V as me,a as fe,d as pe,b as he,c as _e}from"./1ZPuLRBT.js";import{V as ge,a as ye}from"./D4N3AJSv.js";import{a as q,V as K,b as ve}from"./MZDb2Wcg.js";import{_ as be}from"./BJ1nRgUz.js";import{_ as ke}from"./BayVzq8k.js";import"./DQiwTzrJ.js";import"./BxUAMrhL.js";import"./DH5RAi3T.js";import"./B931MWyl.js";import"./CVKIk_o5.js";import"./BbdJ6orW.js";import"./Ct-l0l1E.js";import"./DsEisNnw.js";import"./CCfVRiHa.js";import"./pIIQsBHX.js";import"./Ch8e8etN.js";import"./D2vPiwbM.js";import"./CgbmeEYS.js";import"./DN4H-Mtc.js";import"./DD68NtD1.js";import"./D9OwnUGw.js";import"./CDHuI93o.js";/* empty css        */import"./BZRvyWuu.js";const Ce={class:"d-flex justify-space-between align-center w-100"},De={class:"text-truncate text-subtitle-2 text-sm-h6 font-weight-regular mx-2"},Ve={class:"text-uppercase",style:{overflow:"hidden","text-overflow":"ellipsis"}},we={key:0,class:"text-h6 text-sm-h5 ml-2"},Se=P({name:"ScheduleButton",__name:"ScheduleButton",props:{fertilizerName:{},amount:{},status:{}},setup($){const h=$,_=v(()=>["primary","primary","grey"][h.status]),u=v(()=>["outlined","elevated","outlined"][h.status]);return(l,D)=>(r(),b(T,J(l.$attrs,{block:"",size:"x-large",tile:"",color:e(_),variant:e(u),class:"mb-2 px-3",disabled:!l.amount}),{default:s(()=>[m("div",Ce,[m("div",De,[m("div",Ve,n(l.fertilizerName),1)]),l.amount>0?(r(),g("div",we,n(("format"in l?l.format:e(oe))(l.amount)),1)):S("",!0)])]),_:1},16,["color","variant","disabled"]))}}),$e={class:"no-break"},xe={class:"d-flex flex-column text-h4 text-center mb-4"},ze={style:{"text-transform":"capitalize"}},Te=P({name:"ScheduleCard",__name:"ScheduleCard",props:{schedule:{},scheduleIndex:{}},setup($){const{t:h,locale:_}=M(),u=N(),l=ce(),D=H(),{appRoutes:E}=U(),i=$,d=re(0),B=v(()=>{const t=new Date(i.schedule.startDate);return O(t,_.value)}),I=v(()=>{const t=new Date(i.schedule.startDate),o=new Date(t.setDate(t.getDate()+i.schedule.dosing.daysTotal-1));return O(o,_.value)}),k=v(()=>{let[t,...o]=JSON.parse(JSON.stringify(i.schedule.days));return o||(o=[]),t?t.fertilizers={...i.schedule.waterChangeDay.fertilizers,...t.fertilizers}:t={...i.schedule.waterChangeDay},[t,...o]}),C=v(()=>k.value.length),R=v(()=>(d.value+1)/C.value*100);ue(()=>{d.value=W()});function W(){const t=F(i.schedule.waterChangeDay.fertilizers).some(f=>f.status===G.ACTIVE&&f.amount);let o=0;return t||(o=k.value.findIndex(f=>F(f.fertilizers).some(y=>y.status===G.ACTIVE&&y.amount))),o===-1?C.value-1:o}function j(t,o,f){D.toggleDay(t,o,f)}function x(t,o){D.toggleWaterChangeDay(t,o)}function Q(){d.value>=1&&(d.value-=1)}function X(){d.value<C.value-1&&(d.value+=1)}async function Y(){l.setDaysTotal(i.schedule.dosing.daysTotal),l.setFertilizersRegime(i.schedule.dosing.fertilizersRegime),l.setTank(i.schedule.dosing.tank),l.setDoses(i.schedule.dosing.doses),await u.push(`${E.value.dosing.path}?schedule=${i.scheduleIndex}`)}return(t,o)=>{const f=Se;return r(),b(me,J(t.$attrs,{elevation:"4"}),{default:s(()=>[a(fe,{class:"d-flex justify-space-between align-start font-weight-regular flex-nowrap"},{default:s(()=>[m("div",$e,n(t.schedule.dosing.tank.name),1)]),_:1}),a(pe,{class:"mt-n3"},{default:s(()=>[c(n(e(B))+" - "+n(e(I)),1)]),_:1}),a(he,{class:"mt-6 mb-4"},{default:s(()=>[a(ge,{modelValue:e(d),"onUpdate:modelValue":o[0]||(o[0]=y=>ie(d)?d.value=y:null)},{default:s(()=>[(r(!0),g(w,null,A(e(k),(y,z)=>(r(),b(ye,{key:`${z}-content`},{default:s(()=>[a(q,null,{default:s(()=>[a(K,{cols:"12",sm:"10","offset-sm":"1"},{default:s(()=>{var L;return[m("div",xe,[m("div",null,[m("span",ze,n(("getWeekday"in t?t.getWeekday:e(ne))(y.date,e(_))),1),o[1]||(o[1]=c(", ")),m("span",null,n(("formatDate"in t?t.formatDate:e(O))(y.date,e(_))),1)])]),z===0?(r(!0),g(w,{key:0},A(t.schedule.waterChangeDay.fertilizers,(V,p)=>(r(),g("div",{key:`water_change_${p}`},[a(f,{"fertilizer-name":p,amount:V.amount,status:V.status,onClick:Z=>x(t.scheduleIndex,p)},{default:s(()=>[c(n(p),1)]),_:2},1032,["fertilizer-name","amount","status","onClick"])]))),128)):S("",!0),(r(!0),g(w,null,A(((L=t.schedule.days[z])==null?void 0:L.fertilizers)||{},(V,p)=>(r(),g("div",{key:`water_change_${p}`},[a(f,{"fertilizer-name":p,amount:V.amount,status:V.status,onClick:Z=>j(t.scheduleIndex,z,p)},{default:s(()=>[c(n(p),1)]),_:2},1032,["fertilizer-name","amount","status","onClick"])]))),128))]}),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1}),a(_e,{class:"d-flex justify-end"},{default:s(()=>[e(k).length>1?(r(),g(w,{key:0},[a(T,{disabled:e(d)===0,onClick:Q},{default:s(()=>[c(n(e(h)("buttons.back")),1)]),_:1},8,["disabled"]),a(T,{disabled:e(d)===e(C)-1,class:"ml-0 ml-sm-3",onClick:X},{default:s(()=>[c(n(e(h)("buttons.next")),1)]),_:1},8,["disabled"])],64)):S("",!0),a(T,{class:"ml-0 ml-sm-3",onClick:Y},{default:s(()=>[c(n(e(h)("buttons.edit")),1)]),_:1})]),_:1}),a(le,{color:"primary","model-value":e(R)},null,8,["model-value"])]),_:1},16)}}}),Ae={class:"mb-2"},Be={class:"mb-2"},ft=P({__name:"index",setup($){const h=N(),{appRoutes:_}=U(),{t:u}=M(),l=H();function D(){return h.push(`${_.value.dosing.path}`)}return de({title:u("meta.schedules.title"),description:u("meta.schedules.description"),keywords:u("meta.schedules.keywords")}),(E,i)=>{const d=ee,B=te,I=se,k=Te,C=be,R=ke,W=ae;return r(),b(ve,{"min-height":"100%",class:"mb-12 position-relative"},{default:s(()=>[a(q,null,{default:s(()=>[a(d,null,{default:s(()=>[c(n(e(u)("schedules.title")),1)]),_:1}),a(R,null,{default:s(()=>[e(l).schedules.length===0?(r(),b(B,{key:0},{default:s(()=>[c(n(e(u)("schedules.empty")),1)]),_:1})):S("",!0),e(l).schedules.length===0?(r(),b(I,{key:1,class:"mb-16"},{default:s(()=>[c(n(e(u)("schedules.hints.p3")),1)]),_:1})):S("",!0),a(K,{sm:"10",md:"8","offset-sm":"1","offset-md":"2"},{default:s(()=>[(r(!0),g(w,null,A(e(l).schedules,(j,x)=>(r(),b(k,{key:x,schedule:j,"schedule-index":x,class:"mb-10"},null,8,["schedule","schedule-index"]))),128))]),_:1}),a(C,null,{default:s(()=>[m("p",Ae,n(e(u)("schedules.hints.p1")),1),m("p",Be,n(e(u)("schedules.hints.p2")),1)]),_:1})]),_:1})]),_:1}),a(W,{action:D},{default:s(()=>[c(n(e(u)("schedules.addButton")),1)]),_:1})]),_:1})}}});export{ft as default};
