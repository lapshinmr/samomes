var ue=Object.defineProperty;var de=(y,s,l)=>s in y?ue(y,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):y[s]=l;var L=(y,s,l)=>de(y,typeof s!="symbol"?s+"":s,l);import{_ as he}from"./D8L4ddpU.js";import{_ as ce}from"./BAlGtWDv.js";import{a as pe,_ as fe}from"./BFeahmug.js";import{_ as ge}from"./CMs0IOao.js";import{_ as ke}from"./TxGqIVzn.js";import{t as Z,f as I}from"./DHChNhVW.js";import{D as A,a as m}from"./BoIzNFIF.js";import{e as be,k as Ve,N as Ce,r as D,E as W,A as ve,h as z,w as d,o as u,b as r,d as X,t as T,j as e,c as w,i as g,a as k,z as F,M as j,H as _e,L as ze}from"./4DDGlPu9.js";import{u as ye}from"./BraOfSPb.js";import{u as Te}from"./B3om8Xhj.js";import{u as we}from"./BJARJ5Mr.js";import{u as Fe}from"./CVm5WXKH.js";import{u as xe}from"./Dw-wCBdr.js";import{u as Pe}from"./C-kXbRrJ.js";import{u as Re}from"./CUZIdrTu.js";import{R as Q}from"./CgbmeEYS.js";import{M as Y}from"./pIIQsBHX.js";import{F as Ie,a as We}from"./NKOkaf8o.js";import{D as E}from"./DsEisNnw.js";import{a as G}from"./ChtXI062.js";import{b as Me,a as Se,V as Ge}from"./BEWM2UJB.js";import{V as He}from"./pn0yBbum.js";import{a as Ne,V as $}from"./Csi3Qo0Q.js";import{V as Ue}from"./OcCitwYj.js";import{V as Ae}from"./Bhla4Hl_.js";import{V as K}from"./BqA8cAIL.js";import"./B931MWyl.js";import"./bzDsmipn.js";import"./B_yGS1YP.js";import"./CIUUx1Lt.js";import"./CKJfut37.js";import"./D5xaZfaH.js";import"./D1J_CxX2.js";import"./DpWlsX81.js";import"./vnWA3dHU.js";import"./T2xCpJ1C.js";import"./DPOVp56R.js";import"./C6uoOoNV.js";import"./Pi4BUpqD.js";import"./CCfVRiHa.js";import"./BBggtmFf.js";import"./D2vPiwbM.js";import"./Ch8e8etN.js";/* empty css        */class De{constructor(s,l){L(this,"doses");L(this,"tank");this.doses=s,this.tank=l}get isDoses(){return this.doses.length>0}get fertilizersHardness(){const s={gh:0,kh:0};return this.doses.forEach(l=>{var a,v;let c,C;if("hardness"in l.fertilizer&&((a=l.fertilizer.hardness)!=null&&a.gh||(v=l.fertilizer.hardness)!=null&&v.kh)){const h=l.fertilizer.hardness;c=h.gh*l.amount*h.volume/(h.amount*this.tank.waterChangeVolume),C=h.kh*l.amount*h.volume/(h.amount*this.tank.waterChangeVolume)}else c=Q.countGh(l.fertilizer.concentration,l.amount,this.tank.waterChangeVolume)??0,C=Q.countKh(l.fertilizer.concentration,l.amount,this.tank.waterChangeVolume)??0,l.fertilizer.isLiquid&&(c/=Y,C/=Y);s.gh+=c,s.kh+=C}),s}countWaterChangeGh(s,l){return s*(1-l/100)+this.fertilizersHardness.gh}countTotalGh(s,l,c){const v=l*(1-c/100)*this.tank.waterChangePercent/100,h=s*(1-this.tank.waterChangePercent/100),x=this.fertilizersHardness.gh*this.tank.waterChangePercent/100;return h+v+x}countWaterChangeKh(s,l){return s*(1-l/100)+this.fertilizersHardness.kh}countTotalKh(s,l,c){const v=l*(1-c/100)*this.tank.waterChangePercent/100,h=s*(1-this.tank.waterChangePercent/100),x=this.fertilizersHardness.kh*this.tank.waterChangePercent/100;return h+v+x}}const Ee={key:0},Ke={class:"mt-2 mt-sm-6"},Le={class:"d-flex flex-column flex-md-row"},Xe={key:0},$e={class:"text-subtitle-1"},Be={class:"d-flex flex-column flex-sm-row align-sm-center"},Oe={key:0},qe={class:"text-headline mt-8"},Je={class:"d-flex"},Ze={class:"d-flex"},je={key:0,class:"mt-8"},Qe={class:"d-flex flex-column flex-sm-row align-md-center mb-8"},Ye={key:0,class:"mt-8"},et={class:"text-subtitle-1 mb-2"},tt={class:"d-flex"},st={class:"d-flex"},qt=be({name:"HardnessPage",__name:"index",setup(y){const{t:s,locale:l}=Ve(),{required:c}=ye(),{smAndUp:C}=Ce(),a=Te(),v=we(),h=Fe(),x=xe(),B=Pe(),ee=Re(),te=v.tankModels.map(t=>t.toJson()),M=D(0),S=D(0),P=D(0),R=D(0),H=t=>!Number.isNaN(+t)&&+t!=1/0||"Проверьте вводимые параметры",N=W(()=>new De(a.doseModels,a.tank)),U=W({get(){return a.isDefaultFertilizers},set(t){a.setDefaultFertilizers(t),ee.show(t?"Фирменные удобрения добавлены в список":"Фирменные удобрения удалены из списка")}}),se=W(()=>{const t=JSON.parse(JSON.stringify(Ie));return l.value==="en"&&We.forEach(n=>{const b=t.find(f=>n.key===f.key);b&&(b.name=n.name,b.description=n.description)}),t.sort((n,b)=>n.name.localeCompare(b.name)),t}),ae=W(()=>{let t=[];if(U.value){const n=h.fertilizerRecipes.map(V=>V.name),b=x.fertilizers.map(V=>V.name),f=B.remineralRecipes.map(V=>V.name);t=se.value.filter(V=>![...n,...b,...f].includes(V.name))}return[...h.fertilizerRecipes.map(n=>new E({fertilizer:n,fertilizerType:A.fertilizerRecipe,daysTotal:1})),...x.fertilizers.map(n=>new E({fertilizer:n,fertilizerType:A.fertilizer,daysTotal:1})),...B.remineralRecipes.map(n=>new E({fertilizer:n,fertilizerType:A.remineralRecipe,daysTotal:1})),...t.map(n=>new E({fertilizer:n,fertilizerType:A.fertilizer,daysTotal:1}))]}),p=W({get(){return a.remineralizationType},set(t){a.setRemineralizationType(t),a.setDoses([]),M.value=0,S.value=0,P.value=0,R.value=0}}),_=W({get(){return a.isTests},set(t){a.setIsTests(t)}});function ne(t){if(typeof t=="number"){a.setTank({name:t.toString(),volume:t});return}else if(typeof t=="string"||t===null)return;a.setTank({name:t.name,volume:t.volumeTotal,waterChangeVolume:t.waterChangeVolume||0,waterChangePercent:t.waterChangePercent||0})}function le(t){t.length>a.doseModels.length&&typeof[...t].pop()=="string"||a.setDoses(t)}function O(t){t<0||t<=100&&(a.setWaterChangePercent(t),a.setWaterChangeVolume(I(a.tank.volume*t/100,3)))}function q(t){t<0||t<=a.tank.volume&&(a.setWaterChangeVolume(t),a.setWaterChangePercent(I(t/a.tank.volume*100,3)))}function J(t){t<0||t<=100&&a.setOsmosisChangePercent(+t)}function re(){a.reset()}return ve({title:s("meta.hardness.title"),description:s("meta.hardness.description"),keywords:s("meta.hardness.keywords")}),(t,n)=>{const b=he,f=ce,V=fe,oe=ge,ie=ke;return u(),z(Me,{class:"mb-10"},{default:d(()=>[r(Se,null,{default:d(()=>[r(b,null,{button:d(()=>[r(He,{color:"primary",onClick:re},{default:d(()=>[X(T(e(s)("buttons.reset")),1)]),_:1})]),default:d(()=>[X(T(e(s)("hardness.title"))+" ",1)]),_:1}),r(Ge,{cols:"12",sm:"10",md:"8","offset-sm":"1","offset-md":"2"},{default:d(()=>[r(oe,null,{default:d(()=>[r(pe,{modelValue:e(a).tank,"onUpdate:modelValue":[n[0]||(n[0]=i=>e(a).tank=i),ne],modelModifiers:{number:!0},items:e(te),"item-title":"name",variant:"underlined",label:e(s)("hardness.tankInputLabel"),hint:e(s)("hardness.tankInputHint"),"persistent-hint":"","hide-selected":"",rules:[e(c)],class:"mb-4"},null,8,["modelValue","items","label","hint","rules"]),r(G,null,{default:d(()=>{var i;return[(i=e(a).tank)!=null&&i.volume?(u(),w("div",Ee,[k("div",Ke,T(e(s)("hardness.waterChangeType")),1),k("div",Le,[r(Ne,{modelValue:e(p),"onUpdate:modelValue":n[1]||(n[1]=o=>F(p)?p.value=o:null),class:"my-2 ml-n2",color:"primary","hide-details":"auto",inline:e(C)},{default:d(()=>[r($,{label:e(s)("hardness.osmosisAndRem"),value:e(m).REM},null,8,["label","value"]),r($,{label:e(s)("hardness.osmosisAndTap"),value:e(m).TAP,class:"mt-1 mt-sm-0 ml-sm-2"},null,8,["label","value"]),r($,{label:e(s)("hardness.otherType"),value:e(m).MIX,class:"mt-1 mt-sm-0 ml-sm-2"},null,8,["label","value"])]),_:1},8,["modelValue","inline"]),r(Ue,{modelValue:e(_),"onUpdate:modelValue":n[2]||(n[2]=o=>F(_)?_.value=o:null),color:"primary",class:"ml-n2 ml-0",label:e(s)("hardness.isTests")},null,8,["modelValue","label"])])])):g("",!0)]}),_:1}),r(G,null,{default:d(()=>{var i;return[(i=e(a).tank)!=null&&i.volume&&e(p)!==null?(u(),w("div",Xe,[k("div",$e,T(e(s)("hardness.chooseVolumeHint")),1),k("div",Be,[r(f,{"model-value":e(a).tank.waterChangeVolume,label:e(s)("hardness.volumeInputLabel"),hint:e(s)("hardness.volumeInputHint"),"persistent-hint":"",suffix:e(s)("units.l"),class:"pt-0 mt-0","append-icon":"mdi-arrow-up-bold-circle-outline","onUpdate:modelValue":q,"onClick:append":n[3]||(n[3]=o=>q(e(a).tank.volume))},null,8,["model-value","label","hint","suffix"]),r(f,{"model-value":e(a).tank.waterChangePercent,label:e(s)("hardness.changeInputLabel"),hint:e(s)("hardness.changeInputHint"),"persistent-hint":"",suffix:"%",class:"pt-0 mt-0 ml-sm-3","append-icon":"mdi-arrow-up-bold-circle-outline","onUpdate:modelValue":O,"onClick:append":n[4]||(n[4]=o=>O(100))},null,8,["model-value","label","hint"]),[e(m).TAP,e(m).MIX].includes(e(p))?(u(),z(f,{key:0,"model-value":e(a).osmosisChangePercent,label:e(s)("hardness.osmosisPercentLabel"),hint:e(s)("hardness.osmosisPercentHint",{osmosisChangeVolume:("toFixed"in t?t.toFixed:e(Z))(e(a).osmosisChangeVolume,1),tapChangeVolume:("toFixed"in t?t.toFixed:e(Z))(e(a).tapChangeVolume,1)}),"persistent-hint":"",class:"mt-0 pt-0 ml-sm-3","single-line":"",suffix:"%","append-icon":"mdi-arrow-up-bold-circle-outline","onUpdate:modelValue":J,"onClick:append":n[5]||(n[5]=o=>J(100))},null,8,["model-value","label","hint"])):g("",!0)]),r(G,null,{default:d(()=>[e(_)||[e(m).TAP,e(m).MIX].includes(e(p))?(u(),w("div",Oe,[k("div",qe,T(e(s)("hardness.initHardness")),1),k("div",Je,[[e(m).TAP,e(m).MIX].includes(e(p))?(u(),z(f,{key:0,modelValue:e(P),"onUpdate:modelValue":n[6]||(n[6]=o=>F(P)?P.value=o:null),label:e(s)("hardness.tapWaterGh"),suffix:"Gh","hide-details":"auto"},null,8,["modelValue","label"])):g("",!0),e(_)?(u(),z(f,{key:1,modelValue:e(M),"onUpdate:modelValue":n[7]||(n[7]=o=>F(M)?M.value=o:null),label:e(s)("hardness.tankWaterGh"),suffix:"Gh","hide-details":"auto",class:j({"ml-3":[e(m).TAP,e(m).MIX].includes(e(p))})},null,8,["modelValue","label","class"])):g("",!0)]),k("div",Ze,[[e(m).TAP,e(m).MIX].includes(e(p))?(u(),z(f,{key:0,modelValue:e(R),"onUpdate:modelValue":n[8]||(n[8]=o=>F(R)?R.value=o:null),label:e(s)("hardness.tapWaterKh"),suffix:"Kh","hide-details":"auto"},null,8,["modelValue","label"])):g("",!0),e(_)?(u(),z(f,{key:1,modelValue:e(S),"onUpdate:modelValue":n[9]||(n[9]=o=>F(S)?S.value=o:null),label:e(s)("hardness.tankWaterKh"),suffix:"Kh","hide-details":"auto",class:j({"ml-3":[e(m).TAP,e(m).MIX].includes(e(p))})},null,8,["modelValue","label","class"])):g("",!0)])])):g("",!0)]),_:1})])):g("",!0)]}),_:1}),r(G,null,{default:d(()=>{var i;return[(i=e(a).tank)!=null&&i.volume&&[e(m).REM,e(m).MIX].includes(e(p))?(u(),w("div",je,[k("div",Qe,[r(V,{"model-value":e(a).doseModels,items:e(ae),variant:"underlined",label:e(s)("dosing.fertilizersInputLabel"),hint:e(s)("dosing.fertilizersInputHint"),"item-title":"fertilizer.name","persistent-hint":"",multiple:"",chips:"","closable-chips":"",class:"mb-4","onUpdate:modelValue":le},null,8,["model-value","items","label","hint"]),r(Ae,{modelValue:e(U),"onUpdate:modelValue":n[10]||(n[10]=o=>F(U)?U.value=o:null),color:"primary",label:e(s)("dosing.switch"),class:"ml-md-4 flex-shrink-0"},null,8,["modelValue","label"])])])):g("",!0)]}),_:1}),(u(!0),w(_e,null,ze(e(a).doseModels,(i,o)=>(u(),w("div",{key:`dose_${o}`},[r(f,{"model-value":i.amount,label:i.fertilizer.name,suffix:i.fertilizer.isLiquid?e(s)("units.ml"):e(s)("units.g"),"hide-details":"auto",class:"mb-2","onUpdate:modelValue":me=>e(a).updateAmountDay(me,o)},null,8,["model-value","label","suffix","onUpdate:modelValue"])]))),128)),r(G,null,{default:d(()=>{var i;return[(i=e(a).tank)!=null&&i.volume&&e(p)!==null?(u(),w("div",Ye,[k("div",et,T(e(s)("hardness.resultHardness")),1),k("div",null,[k("div",tt,[r(K,{"model-value":("format"in t?t.format:e(I))(e(N).countWaterChangeGh(e(P),e(a).osmosisChangePercent)),label:e(s)("hardness.result.changeWaterGh"),suffix:"Gh","hide-details":"auto",readonly:"",variant:"outlined","persistent-hint":"",class:"mb-3",rules:[H]},null,8,["model-value","label","rules"]),e(_)?(u(),z(K,{key:0,"model-value":("format"in t?t.format:e(I))(e(N).countTotalGh(e(M),e(P),e(a).osmosisChangePercent)),label:e(s)("hardness.result.tankWaterGh"),suffix:"Gh","hide-details":"auto",readonly:"",variant:"outlined","persistent-hint":"",class:"mb-3 ml-3",rules:[H]},null,8,["model-value","label","rules"])):g("",!0)]),k("div",st,[r(K,{"model-value":("format"in t?t.format:e(I))(e(N).countWaterChangeKh(e(R),e(a).osmosisChangePercent)),label:e(s)("hardness.result.changeWaterKh"),suffix:"Kh","hide-details":"auto",readonly:"",variant:"outlined","persistent-hint":"",rules:[H]},null,8,["model-value","label","rules"]),e(_)?(u(),z(K,{key:0,"model-value":("format"in t?t.format:e(I))(e(N).countTotalKh(e(S),e(R),e(a).osmosisChangePercent)),label:e(s)("hardness.result.tankWaterKh"),suffix:"Kh","hide-details":"auto",readonly:"",variant:"outlined","persistent-hint":"",class:"ml-3",rules:[H]},null,8,["model-value","label","rules"])):g("",!0)])])])):g("",!0)]}),_:1})]),_:1})]),_:1}),r(ie,null,{default:d(()=>[X(T(e(s)("hardness.hints.p1")),1)]),_:1})]),_:1})]),_:1})}}});export{qt as default};
