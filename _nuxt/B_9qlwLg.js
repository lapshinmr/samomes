import{_ as X}from"./BennhIYQ.js";import{_ as Y,a as Z,b as ee}from"./ZnY5Jr4l.js";import{f as te,b as j,a as se}from"./DHChNhVW.js";import{V as x,f as ae}from"./_MrG4Qzc.js";import{e as E,E as y,h as v,o as l,I as P,j as t,w as s,a as m,c as _,i as w,t as o,k as N,G,r as oe,f as ne,b as a,d as c,z as le,K as z,H as V,A as re}from"./C4AY6iDY.js";import{A as ue,F as ie}from"./BoIzNFIF.js";import{u as de}from"./DDJqf7YD.js";import{u as J}from"./DpRw7U6r.js";import{u as K}from"./CJauG_RX.js";import{b as ce}from"./BBggtmFf.js";import{V as me,a as fe,d as pe,b as he,c as _e}from"./Bf45qiAc.js";import{V as ge,a as ye}from"./9bPvczp2.js";import{a as L,V as M,b as ve}from"./D_ojGsqK.js";import{_ as be}from"./C9wVp3-b.js";import{_ as ke}from"./Dc-nFeH9.js";import"./Dd_ptEuo.js";import"./DDO_tocw.js";import"./C_viBdnf.js";import"./B931MWyl.js";import"./C1PmHpO2.js";import"./BJEZURo1.js";import"./85aYgJ7U.js";import"./Ckubnz2N.js";import"./DxcjxDr2.js";import"./BQGgX5ID.js";import"./Ch8e8etN.js";import"./D2vPiwbM.js";import"./ciCyplrD.js";import"./DFmCVkFv.js";import"./CEN1ZApb.js";import"./qzx_-4Xp.js";import"./D_YM2NF9.js";/* empty css        */import"./CsOvkQMc.js";const Ce={class:"d-flex justify-space-between align-center w-100"},De={class:"text-truncate text-subtitle-2 text-sm-h6 font-weight-regular mx-2"},Ve={class:"text-uppercase",style:{overflow:"hidden","text-overflow":"ellipsis"}},we={key:0,class:"text-h6 text-sm-h5 ml-2"},Se=E({name:"ScheduleButton",__name:"ScheduleButton",props:{fertilizerName:{},amount:{},status:{}},setup(S){const p=S,h=y(()=>["primary","primary","grey"][p.status]),u=y(()=>["outlined","elevated","outlined"][p.status]);return(n,k)=>(l(),v(x,P(n.$attrs,{block:"",size:"x-large",tile:"",color:t(h),variant:t(u),class:"mb-2 px-3",disabled:!n.amount}),{default:s(()=>[m("div",Ce,[m("div",De,[m("div",Ve,o(n.fertilizerName),1)]),n.amount>0?(l(),_("div",we,o(("format"in n?n.format:t(te))(n.amount)),1)):w("",!0)])]),_:1},16,["color","variant","disabled"]))}}),$e={class:"no-break"},xe={class:"d-flex flex-column text-h4 text-center mb-4"},ze={style:{"text-transform":"capitalize"}},Re=E({name:"ScheduleCard",__name:"ScheduleCard",props:{schedule:{},scheduleIndex:{}},setup(S){const{t:p,locale:h}=N(),u=G(),n=de(),k=J(),{appRoutes:F}=K(),d=S,i=oe(0),R=y(()=>{const e=new Date(d.schedule.startDate);return j(e,h.value)}),T=y(()=>{const e=new Date(d.schedule.startDate),r=new Date(e.setDate(e.getDate()+d.schedule.dosing.daysTotal-1));return j(r,h.value)}),b=y(()=>d.schedule.dosing.daysTotal),A=y(()=>(i.value+1)/b.value*100),B=y(()=>{const[e,...r]=JSON.parse(JSON.stringify(d.schedule.days));return e.fertilizers={...d.schedule.waterChangeDay.fertilizers,...e.fertilizers},[e,...r]});ne(()=>{i.value=I()});function I(){const e=B.value.findIndex(r=>ce(r.fertilizers).some(g=>g.status===ue.ACTIVE&&g.amount));return e===-1?b.value-1:e}function W(e,r,g){k.toggleDay(e,r,g)}function $(e,r){k.toggleWaterChangeDay(e,r)}function H(){i.value>=1&&(i.value-=1)}function U(){i.value<b.value-1&&(i.value+=1)}async function q(){n.setDaysTotal(d.schedule.dosing.daysTotal),n.setFertilizersRegime(d.schedule.dosing.fertilizersRegime),n.setTank(d.schedule.dosing.tank),n.setDoses(d.schedule.dosing.doses),await u.push(`${F.value.dosing.path}?schedule=${d.scheduleIndex}`)}return(e,r)=>{const g=Se;return l(),v(me,P(e.$attrs,{elevation:"4"}),{default:s(()=>[a(fe,{class:"d-flex justify-space-between align-start font-weight-regular flex-nowrap"},{default:s(()=>[m("div",$e,o(e.schedule.dosing.tank.name),1)]),_:1}),a(pe,{class:"mt-n3"},{default:s(()=>[c(o(t(R))+" - "+o(t(T)),1)]),_:1}),a(he,{class:"mt-6 mb-4"},{default:s(()=>[a(ge,{modelValue:t(i),"onUpdate:modelValue":r[0]||(r[0]=C=>le(i)?i.value=C:null)},{default:s(()=>[(l(!0),_(V,null,z(e.schedule.days,(C,O)=>(l(),v(ye,{key:`${O}-content`},{default:s(()=>[a(L,null,{default:s(()=>[a(M,{cols:"12",sm:"10","offset-sm":"1"},{default:s(()=>[m("div",xe,[m("div",null,[m("span",ze,o(("getWeekday"in e?e.getWeekday:t(se))(C.date,t(h))),1),r[1]||(r[1]=c(", ")),m("span",null,o(("formatDate"in e?e.formatDate:t(j))(C.date,t(h))),1)])]),O===0?(l(!0),_(V,{key:0},z(e.schedule.waterChangeDay.fertilizers,(D,f)=>(l(),_("div",{key:`water_change_${f}`},[a(g,{"fertilizer-name":f,amount:D.amount,status:D.status,onClick:Q=>$(e.scheduleIndex,f)},{default:s(()=>[c(o(f),1)]),_:2},1032,["fertilizer-name","amount","status","onClick"])]))),128)):w("",!0),(l(!0),_(V,null,z(C.fertilizers,(D,f)=>(l(),_("div",{key:`water_change_${f}`},[a(g,{"fertilizer-name":f,amount:D.amount,status:D.status,onClick:Q=>W(e.scheduleIndex,O,f)},{default:s(()=>[c(o(f),1)]),_:2},1032,["fertilizer-name","amount","status","onClick"])]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1}),a(_e,null,{default:s(()=>[e.schedule.dosing.fertilizersRegime!==("FertilizersRegime"in e?e.FertilizersRegime:t(ie)).ONCE_A_WEEK?(l(),_(V,{key:0},[a(x,{disabled:t(i)===0,class:"ml-auto",onClick:H},{default:s(()=>[c(o(t(p)("buttons.back")),1)]),_:1},8,["disabled"]),a(x,{disabled:t(i)===t(b)-1,class:"ml-0 ml-sm-3",onClick:U},{default:s(()=>[c(o(t(p)("buttons.next")),1)]),_:1},8,["disabled"])],64)):w("",!0),a(x,{class:"ml-0 ml-sm-3",onClick:q},{default:s(()=>[c(o(t(p)("buttons.edit")),1)]),_:1})]),_:1}),a(ae,{color:"primary","model-value":t(A)},null,8,["model-value"])]),_:1},16)}}}),Te={class:"mb-2"},Ae={class:"mb-2"},ft=E({__name:"index",setup(S){const p=G(),{appRoutes:h}=K(),{t:u}=N(),n=J();function k(){return p.push(`${h.value.dosing.path}`)}return re({title:u("meta.schedules.title"),description:u("meta.schedules.description"),keywords:u("meta.schedules.keywords")}),(F,d)=>{const i=X,R=Y,T=Z,b=Re,A=be,B=ke,I=ee;return l(),v(ve,{"min-height":"100%",class:"mb-12 position-relative"},{default:s(()=>[a(L,null,{default:s(()=>[a(i,null,{default:s(()=>[c(o(t(u)("schedules.title")),1)]),_:1}),a(B,null,{default:s(()=>[t(n).schedules.length===0?(l(),v(R,{key:0},{default:s(()=>[c(o(t(u)("schedules.empty")),1)]),_:1})):w("",!0),t(n).schedules.length===0?(l(),v(T,{key:1,class:"mb-16"},{default:s(()=>[c(o(t(u)("schedules.hints.p3")),1)]),_:1})):w("",!0),a(M,{sm:"10",md:"8","offset-sm":"1","offset-md":"2"},{default:s(()=>[(l(!0),_(V,null,z(t(n).schedules,(W,$)=>(l(),v(b,{key:$,schedule:W,"schedule-index":$,class:"mb-10"},null,8,["schedule","schedule-index"]))),128))]),_:1}),a(A,null,{default:s(()=>[m("p",Te,o(t(u)("schedules.hints.p1")),1),m("p",Ae,o(t(u)("schedules.hints.p2")),1)]),_:1})]),_:1})]),_:1}),a(I,{action:k},{default:s(()=>[c(o(t(u)("schedules.addButton")),1)]),_:1})]),_:1})}}});export{ft as default};
