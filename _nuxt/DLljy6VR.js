var ie=Object.defineProperty;var me=(y,s,a)=>s in y?ie(y,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):y[s]=a;var $=(y,s,a)=>me(y,typeof s!="symbol"?s+"":s,a);import{_ as ue}from"./pNMOnmag.js";import{_ as de}from"./B5igi5b3.js";import{a as fe,_ as pe}from"./BALrzxtd.js";import{_ as he}from"./DfMHW5xZ.js";import{_ as ce}from"./CvAqiPS3.js";import{t as O,f as P}from"./DHChNhVW.js";import{D as U,a as m}from"./BoIzNFIF.js";import{e as ge,k as ke,M as Ve,r as D,E as M,A as Ce,h as b,w as d,o as u,b as o,d as E,t as j,j as e,c as z,i as c,a as g,z as T,L as J,H as ve,K as be}from"./JuhaATjh.js";import{u as ye}from"./rREtR25H.js";import{u as ze}from"./BOJ4Sug_.js";import{u as Te}from"./BaHUrOYk.js";import{u as we}from"./-EC7e2Fq.js";import{u as Fe}from"./DqcmbeE1.js";import{u as _e}from"./IipKWLUl.js";import{u as xe}from"./DfPauhZ1.js";import{R as Z}from"./ciCyplrD.js";import{M as Q}from"./BQGgX5ID.js";import{F as Pe}from"./CFPUExE7.js";import{D as N}from"./Ckubnz2N.js";import{a as G}from"./DtJzTAmK.js";import{b as Re,a as Ie,V as Me}from"./ChgkdzxJ.js";import{V as Ge}from"./DiSit8yO.js";import{a as We,V as L}from"./DDCGwgii.js";import{V as Se}from"./C8BgpwuC.js";import{V as Ke}from"./BQ1XWWTH.js";import{V as A}from"./BX8HXHlC.js";import"./B931MWyl.js";import"./uBztOj3U.js";import"./lhONX-TN.js";import"./BODT0UbO.js";import"./tvPv1uBi.js";import"./DgVQ6c-3.js";import"./D0Ji5Vad.js";import"./OfWyBKvr.js";import"./BrpHng43.js";import"./BI_u1hyo.js";import"./0CtVlzwM.js";import"./CgWPZkS3.js";import"./DxcjxDr2.js";import"./BBggtmFf.js";import"./D2vPiwbM.js";import"./Ch8e8etN.js";/* empty css        */class Ue{constructor(s,a){$(this,"doses");$(this,"tank");this.doses=s,this.tank=a}get isDoses(){return this.doses.length>0}get fertilizersHardness(){const s={gh:0,kh:0};return this.doses.forEach(a=>{var w,V;let p,l;if("hardness"in a.fertilizer&&((w=a.fertilizer.hardness)!=null&&w.gh||(V=a.fertilizer.hardness)!=null&&V.kh)){const f=a.fertilizer.hardness;p=f.gh*a.amount*f.volume/(f.amount*this.tank.waterChangeVolume),l=f.kh*a.amount*f.volume/(f.amount*this.tank.waterChangeVolume)}else p=Z.countGh(a.fertilizer.concentration,a.amount,this.tank.waterChangeVolume)??0,l=Z.countKh(a.fertilizer.concentration,a.amount,this.tank.waterChangeVolume)??0,a.fertilizer.isLiquid&&(p/=Q,l/=Q);s.gh+=p,s.kh+=l}),s}countWaterChangeGh(s,a){return s*(1-a/100)+this.fertilizersHardness.gh}countTotalGh(s,a,p){const V=a*(1-p/100)*this.tank.waterChangePercent/100,f=s*(1-this.tank.waterChangePercent/100),F=this.fertilizersHardness.gh*this.tank.waterChangePercent/100;return f+V+F}countWaterChangeKh(s,a){return s*(1-a/100)+this.fertilizersHardness.kh}countTotalKh(s,a,p){const V=a*(1-p/100)*this.tank.waterChangePercent/100,f=s*(1-this.tank.waterChangePercent/100),F=this.fertilizersHardness.kh*this.tank.waterChangePercent/100;return f+V+F}}const De={key:0},Ne={class:"d-flex flex-column flex-md-row"},Ae={key:0},He={class:"d-flex flex-column flex-sm-row align-sm-center"},$e={key:0},Ee={class:"d-flex"},Le={class:"d-flex"},Xe={key:0,class:"mt-8"},Be={class:"d-flex flex-column flex-sm-row align-md-center mb-8"},qe={key:0,class:"mt-8"},Oe={class:"d-flex"},je={class:"d-flex"},At=ge({name:"HardnessPage",__name:"index",setup(y){const{t:s}=ke(),{required:a}=ye(),{smAndUp:p}=Ve(),l=ze(),w=Te(),{fertilizerRecipes:V}=we(),{fertilizers:f}=Fe(),{remineralRecipes:F}=_e(),Y=xe(),ee=w.tankModels.map(t=>t.toJson()),R=D(0),I=D(0),_=D(0),x=D(0),W=t=>!Number.isNaN(+t)&&+t!=1/0||"Проверьте вводимые параметры",S=M(()=>new Ue(l.doseModels,l.tank)),K=M({get(){return l.isDefaultFertilizers},set(t){l.setDefaultFertilizers(t),Y.show(t?"Фирменные удобрения добавлены в список":"Фирменные удобрения удалены из списка")}}),te=M(()=>{let t=[];if(K.value){const n=V.map(C=>C.name),H=f.map(C=>C.name),k=F.map(C=>C.name);t=Pe.filter(C=>![...n,...H,...k].includes(C.name))}return[...V.map(n=>new N({fertilizer:n,fertilizerType:U.fertilizerRecipe,daysTotal:1})),...f.map(n=>new N({fertilizer:n,fertilizerType:U.fertilizer,daysTotal:1})),...F.map(n=>new N({fertilizer:n,fertilizerType:U.remineralRecipe,daysTotal:1})),...t.map(n=>new N({fertilizer:n,fertilizerType:U.fertilizer,daysTotal:1}))]}),h=M({get(){return l.remineralizationType},set(t){l.setRemineralizationType(t),l.setDoses([]),R.value=0,I.value=0,_.value=0,x.value=0}}),v=M({get(){return l.isTests},set(t){l.setIsTests(t)}});function le(t){if(typeof t=="number"){l.setTank({name:t.toString(),volume:t});return}else if(typeof t=="string"||t===null)return;l.setTank({name:t.name,volume:t.volumeTotal,waterChangeVolume:t.waterChangeVolume||0,waterChangePercent:t.waterChangePercent||0})}function ne(t){t.length>l.doseModels.length&&typeof[...t].pop()=="string"||l.setDoses(t)}function X(t){t<0||t<=100&&(l.setWaterChangePercent(t),l.setWaterChangeVolume(P(l.tank.volume*t/100,3)))}function B(t){t<0||t<=l.tank.volume&&(l.setWaterChangeVolume(t),l.setWaterChangePercent(P(t/l.tank.volume*100,3)))}function q(t){t<0||t<=100&&l.setOsmosisChangePercent(+t)}function se(){l.reset()}return Ce({title:s("meta.hardness.title"),description:s("meta.hardness.description"),keywords:s("meta.hardness.keywords")}),(t,n)=>{const H=ue,k=de,C=pe,ae=he,oe=ce;return u(),b(Re,{class:"mb-10"},{default:d(()=>[o(Ie,null,{default:d(()=>[o(H,null,{button:d(()=>[o(Ge,{color:"primary",onClick:se},{default:d(()=>[E(j(e(s)("buttons.reset")),1)]),_:1})]),default:d(()=>[E(j(e(s)("hardness.title"))+" ",1)]),_:1}),o(Me,{cols:"12",sm:"10",md:"8","offset-sm":"1","offset-md":"2"},{default:d(()=>[o(ae,null,{default:d(()=>[o(fe,{modelValue:e(l).tank,"onUpdate:modelValue":[n[0]||(n[0]=i=>e(l).tank=i),le],modelModifiers:{number:!0},items:e(ee),"item-title":"name",variant:"underlined",label:"Объем аквариума",hint:"Выберите аквариум или введите объем","persistent-hint":"","hide-selected":"",rules:[e(a)],class:"mb-4"},null,8,["modelValue","items","rules"]),o(G,null,{default:d(()=>{var i;return[(i=e(l).tank)!=null&&i.volume?(u(),z("div",De,[n[11]||(n[11]=g("div",{class:"mt-2 mt-sm-6"}," Выберите тип подмены ",-1)),g("div",Ne,[o(We,{modelValue:e(h),"onUpdate:modelValue":n[1]||(n[1]=r=>T(h)?h.value=r:null),class:"my-2 ml-n2",color:"primary","hide-details":"auto",inline:e(p)},{default:d(()=>[o(L,{label:"Осмос + реминерализатор",value:e(m).REM},null,8,["value"]),o(L,{label:"Осмос + водопровод",value:e(m).TAP,class:"mt-1 mt-sm-0"},null,8,["value"]),o(L,{label:"Другое",value:e(m).MIX,class:"mt-1 mt-sm-0"},null,8,["value"])]),_:1},8,["modelValue","inline"]),o(Se,{modelValue:e(v),"onUpdate:modelValue":n[2]||(n[2]=r=>T(v)?v.value=r:null),color:"primary",label:"Тестирую воду"},null,8,["modelValue"])])])):c("",!0)]}),_:1}),o(G,null,{default:d(()=>{var i;return[(i=e(l).tank)!=null&&i.volume&&e(h)!==null?(u(),z("div",Ae,[n[13]||(n[13]=g("div",{class:"text-subtitle-1"}," Введите объем или процент подмены ",-1)),g("div",He,[o(k,{"model-value":e(l).tank.waterChangeVolume,label:"Объем",hint:"Введите объем подмены","persistent-hint":"",suffix:"л",class:"pt-0 mt-0","append-icon":"mdi-arrow-up-bold-circle-outline","onUpdate:modelValue":B,"onClick:append":n[3]||(n[3]=r=>B(e(l).tank.volume))},null,8,["model-value"]),o(k,{"model-value":e(l).tank.waterChangePercent,label:"Процент",hint:"или процент подмены","persistent-hint":"",suffix:"%",class:"pt-0 mt-0 ml-sm-3","append-icon":"mdi-arrow-up-bold-circle-outline","onUpdate:modelValue":X,"onClick:append":n[4]||(n[4]=r=>X(100))},null,8,["model-value"]),[e(m).TAP,e(m).MIX].includes(e(h))?(u(),b(k,{key:0,"model-value":e(l).osmosisChangePercent,label:"Процент",hint:`
                    Осмос: ${("toFixed"in t?t.toFixed:e(O))(e(l).osmosisChangeVolume,1)} л.
                    Водопровод: ${("toFixed"in t?t.toFixed:e(O))(e(l).tapChangeVolume,1)} л.
                  `,"persistent-hint":"",class:"mt-0 pt-0 ml-sm-3","single-line":"",suffix:"%","append-icon":"mdi-arrow-up-bold-circle-outline","onUpdate:modelValue":q,"onClick:append":n[5]||(n[5]=r=>q(100))},null,8,["model-value","hint"])):c("",!0)]),o(G,null,{default:d(()=>[e(v)||[e(m).TAP,e(m).MIX].includes(e(h))?(u(),z("div",$e,[n[12]||(n[12]=g("div",{class:"text-headline mt-8"}," Исходная жесткость ",-1)),g("div",Ee,[[e(m).TAP,e(m).MIX].includes(e(h))?(u(),b(k,{key:0,modelValue:e(_),"onUpdate:modelValue":n[6]||(n[6]=r=>T(_)?_.value=r:null),label:"Gh водопровода",suffix:"Gh","hide-details":"auto"},null,8,["modelValue"])):c("",!0),e(v)?(u(),b(k,{key:1,modelValue:e(R),"onUpdate:modelValue":n[7]||(n[7]=r=>T(R)?R.value=r:null),label:"Gh в аквариуме",suffix:"Gh","hide-details":"auto",class:J({"ml-3":[e(m).TAP,e(m).MIX].includes(e(h))})},null,8,["modelValue","class"])):c("",!0)]),g("div",Le,[[e(m).TAP,e(m).MIX].includes(e(h))?(u(),b(k,{key:0,modelValue:e(x),"onUpdate:modelValue":n[8]||(n[8]=r=>T(x)?x.value=r:null),label:"Kh водопровода",suffix:"Kh","hide-details":"auto"},null,8,["modelValue"])):c("",!0),e(v)?(u(),b(k,{key:1,modelValue:e(I),"onUpdate:modelValue":n[9]||(n[9]=r=>T(I)?I.value=r:null),label:"Kh в аквариуме",suffix:"Kh","hide-details":"auto",class:J({"ml-3":[e(m).TAP,e(m).MIX].includes(e(h))})},null,8,["modelValue","class"])):c("",!0)])])):c("",!0)]),_:1})])):c("",!0)]}),_:1}),o(G,null,{default:d(()=>{var i;return[(i=e(l).tank)!=null&&i.volume&&[e(m).REM,e(m).MIX].includes(e(h))?(u(),z("div",Xe,[g("div",Be,[o(C,{"model-value":e(l).doseModels,items:e(te),variant:"underlined",label:e(s)("dosing.fertilizersInputLabel"),hint:e(s)("dosing.fertilizersInputHint"),"item-title":"fertilizer.name","persistent-hint":"",multiple:"",chips:"","closable-chips":"",class:"mb-4","onUpdate:modelValue":ne},null,8,["model-value","items","label","hint"]),o(Ke,{modelValue:e(K),"onUpdate:modelValue":n[10]||(n[10]=r=>T(K)?K.value=r:null),color:"primary",label:e(s)("dosing.switch"),class:"ml-md-4 flex-shrink-0"},null,8,["modelValue","label"])])])):c("",!0)]}),_:1}),(u(!0),z(ve,null,be(e(l).doseModels,(i,r)=>(u(),z("div",{key:`dose_${r}`},[o(k,{"model-value":i.amount,label:i.fertilizer.name,suffix:i.fertilizer.isLiquid?e(s)("units.ml"):e(s)("units.g"),"hide-details":"auto",class:"mb-2","onUpdate:modelValue":re=>e(l).updateAmountDay(re,r)},null,8,["model-value","label","suffix","onUpdate:modelValue"])]))),128)),o(G,null,{default:d(()=>{var i;return[(i=e(l).tank)!=null&&i.volume&&e(h)!==null?(u(),z("div",qe,[n[14]||(n[14]=g("div",{class:"text-subtitle-1 mb-2"}," Подготовленная жесткость ",-1)),g("div",null,[g("div",Oe,[o(A,{"model-value":("format"in t?t.format:e(P))(e(S).countWaterChangeGh(e(_),e(l).osmosisChangePercent)),label:"Gh в подмене",suffix:"Gh","hide-details":"auto",readonly:"",variant:"outlined","persistent-hint":"",class:"mb-3",rules:[W]},null,8,["model-value","rules"]),e(v)?(u(),b(A,{key:0,"model-value":("format"in t?t.format:e(P))(e(S).countTotalGh(e(R),e(_),e(l).osmosisChangePercent)),label:"Gh в аквариуме",suffix:"Gh","hide-details":"auto",readonly:"",variant:"outlined","persistent-hint":"",class:"mb-3 ml-3",rules:[W]},null,8,["model-value","rules"])):c("",!0)]),g("div",je,[o(A,{"model-value":("format"in t?t.format:e(P))(e(S).countWaterChangeKh(e(x),e(l).osmosisChangePercent)),label:"Kh в подмене",suffix:"Kh","hide-details":"auto",readonly:"",variant:"outlined","persistent-hint":"",rules:[W]},null,8,["model-value","rules"]),e(v)?(u(),b(A,{key:0,"model-value":("format"in t?t.format:e(P))(e(S).countTotalKh(e(I),e(x),e(l).osmosisChangePercent)),label:"Kh в аквариуме",suffix:"Kh","hide-details":"auto",readonly:"",variant:"outlined","persistent-hint":"",class:"ml-3",rules:[W]},null,8,["model-value","rules"])):c("",!0)])])])):c("",!0)]}),_:1})]),_:1})]),_:1}),o(oe,null,{default:d(()=>n[15]||(n[15]=[E(" На этой странице можно рассчитать Gh/Kh в аквариуме в зависимости от исходной воды, разбавления осмосом, реминерализатора и дозировок удобрений. ")])),_:1})]),_:1})]),_:1})}}});export{At as default};
