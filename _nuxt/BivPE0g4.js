import{_ as bt}from"./X6MtcrI4.js";import{_ as gt}from"./D8L4ddpU.js";import{b as We,m as ht,a as Je,V as Vt,_ as wt}from"./BFeahmug.js";import{V as fe,_ as Ot}from"./B1YqnSCG.js";import{_ as ve}from"./BAlGtWDv.js";import{_ as Ct}from"./Cvf1YOSE.js";import{f as Y}from"./DHChNhVW.js";import{e as de,k as ce,E as K,c as V,o as r,b as t,w as n,a as M,t as u,j as e,H as N,L as J,M as Ue,d as T,i as D,m as Ce,q as Re,r as P,I as te,O as Ze,P as Rt,s as Ye,Q as ne,R as _t,S as St,T as Pt,C as _e,y as ae,h as Z,z as E,B as ue,D as Tt,f as Ht,U as Mt,V as xt,A as At,W as Nt,J as qt,_ as Et}from"./4DDGlPu9.js";import{H as Oe,T as re,E as me}from"./pIIQsBHX.js";import{s as Ut,A as It,M as se}from"./Ch8e8etN.js";import{V as Bt}from"./CiwXtdbK.js";import{R as ee}from"./BoIzNFIF.js";import{u as Se}from"./BraOfSPb.js";import{u as Xe}from"./BuzPlw-i.js";import{u as Qe}from"./C615Q_KG.js";import{u as ke}from"./CUZIdrTu.js";import{a as ie}from"./ChtXI062.js";import{V as Pe}from"./DHTBsvVg.js";import{a as Te,b as He,c as Me,V as xe}from"./C69-yiqz.js";import{V as W,m as $t,u as Kt,a as Ft}from"./pn0yBbum.js";import{d as Dt,a as Ae,e as Lt,m as Wt}from"./B_yGS1YP.js";import{f as zt,a as jt,s as Gt}from"./B931MWyl.js";import{V as ze,m as Jt,a as je,b as Zt}from"./DS44NlTG.js";import{u as Yt}from"./DPOVp56R.js";import{V as Ve}from"./BqA8cAIL.js";import{a as ye,V as j}from"./Csi3Qo0Q.js";import{V as Ne}from"./vnWA3dHU.js";import{V as qe}from"./Cn_JaUnx.js";import{V as et}from"./OcCitwYj.js";import Xt from"./Cr_eJaku.js";import{u as Qt}from"./BJARJ5Mr.js";import{t as Ie,b as ea}from"./BBggtmFf.js";import{V as ta}from"./Cx8Jdcth.js";import{a as Be,V as we,b as aa}from"./BEWM2UJB.js";import{u as oa}from"./CVh6j9lI.js";import{u as na}from"./CVm5WXKH.js";import{F as la}from"./CCfVRiHa.js";import{u as sa,V as ia}from"./DbTOrhwR.js";import"./bzDsmipn.js";import"./CIUUx1Lt.js";import"./CKJfut37.js";import"./D5xaZfaH.js";import"./D1J_CxX2.js";import"./DpWlsX81.js";import"./T2xCpJ1C.js";import"./C6uoOoNV.js";import"./CgbmeEYS.js";import"./Pi4BUpqD.js";/* empty css        */import"./Dw-wCBdr.js";import"./D2vPiwbM.js";import"./C-kXbRrJ.js";const ua={class:"pl-0 text-center"},ra={style:{"white-space":"nowrap"}},ma={class:"pl-0 text-center"},da={class:"font-weight-medium"},ca={class:"pl-0 text-center"},pa=de({name:"TheElementsTable",__name:"TheRecipeElementsTable",props:{recipe:{}},setup(i){const{t:o}=ce(),b=i,g=K(()=>{const f={...b.recipe.concentrationPerReagent};return delete f[Oe],f}),q=K(()=>Ut(b.recipe.concentration)),l=K(()=>Object.keys(b.recipe.concentration).length);return(f,A)=>{const O=Ct;return r(),V("div",null,[t(Bt,null,{default:n(()=>[M("thead",null,[M("tr",null,[M("th",ua,u(e(o)("common.reagent")),1),(r(!0),V(N,null,J(e(q),([k],C)=>(r(),V("th",{key:k,class:Ue(["text-center",{"pr-0":C===e(l)-1}])},[M("div",ra,u(k)+", "+u(f.recipe.isLiquid?e(o)("units.g/l"):e(o)("units.g/1g")),1)],2))),128))])]),M("tbody",null,[(r(!0),V(N,null,J(e(g),(k,C)=>(r(),V("tr",{key:C},[M("td",ma,u(C),1),(r(!0),V(N,null,J(e(q),([y,m],c)=>(r(),V("td",{key:C+y,class:Ue(["text-center",{"pr-0":c===e(l)-1}])},[k[y]?(r(),V(N,{key:0},[T(u(("format"in f?f.format:e(Y))(k[y]))+" ",1),k[y]/m<1?(r(),V(N,{key:0},[T(" ("+u(("format"in f?f.format:e(Y))(k[y]/m*100,1))+"%) ",1)],64)):D("",!0)],64)):(r(),V(N,{key:1},[T(" — ")],64))],2))),128))]))),128)),M("tr",da,[M("td",ca,u(e(o)("common.total")),1),(r(!0),V(N,null,J(e(q),([k,C],y)=>(r(),V("td",{key:k,class:Ue(["text-center",{"pr-0":y===e(l)-1}])},[C?(r(),V(N,{key:0},[T(u(("format"in f?f.format:e(Y))(C,3)),1)],64)):(r(),V(N,{key:1},[T(" — ")],64))],2))),128))])])]),_:1}),t(O,{concentration:f.recipe.concentration,class:"mt-8"},null,8,["concentration"])])}}}),De=Symbol.for("vuetify:v-tabs"),fa=Re({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Ze($t({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),$e=Ce()({name:"VTab",props:fa(),setup(i,o){let{slots:b,attrs:g}=o;const{textColorClasses:q,textColorStyles:l}=Dt(i,"sliderColor"),f=P(),A=P(),O=K(()=>i.direction==="horizontal"),k=K(()=>{var y,m;return((m=(y=f.value)==null?void 0:y.group)==null?void 0:m.isSelected.value)??!1});function C(y){var c,H;let{value:m}=y;if(m){const h=(H=(c=f.value)==null?void 0:c.$el.parentElement)==null?void 0:H.querySelector(".v-tab--selected .v-tab__slider"),a=A.value;if(!h||!a)return;const x=getComputedStyle(h).color,B=h.getBoundingClientRect(),R=a.getBoundingClientRect(),F=O.value?"x":"y",S=O.value?"X":"Y",U=O.value?"right":"bottom",$=O.value?"width":"height",G=B[F],p=R[F],v=G>p?B[U]-R[U]:B[F]-R[F],L=Math.sign(v)>0?O.value?"right":"bottom":Math.sign(v)<0?O.value?"left":"top":"center",X=(Math.abs(v)+(Math.sign(v)<0?B[$]:R[$]))/Math.max(B[$],R[$])||0,le=B[$]/R[$]||0,oe=1.5;jt(a,{backgroundColor:[x,"currentcolor"],transform:[`translate${S}(${v}px) scale${S}(${le})`,`translate${S}(${v/oe}px) scale${S}(${(X-1)/oe+1})`,"none"],transformOrigin:Array(3).fill(L)},{duration:225,easing:Gt})}}return Ae(()=>{const y=W.filterProps(i);return t(W,te({symbol:De,ref:f,class:["v-tab",i.class],style:i.style,tabindex:k.value?0:-1,role:"tab","aria-selected":String(k.value),active:!1},y,g,{block:i.fixed,maxWidth:i.fixed?300:void 0,"onGroup:selected":C}),{...b,default:()=>{var m;return t(N,null,[((m=b.default)==null?void 0:m.call(b))??i.text,!i.hideSlider&&t("div",{ref:A,class:["v-tab__slider",q.value],style:l.value},null)])}})}),zt({},f)}}),ya=Re({...Ze(Jt(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),tt=Ce()({name:"VTabsWindow",props:ya(),emits:{"update:modelValue":i=>!0},setup(i,o){let{slots:b}=o;const g=Rt(De,null),q=Ye(i,"modelValue"),l=K({get(){var f;return q.value!=null||!g?q.value:(f=g.items.value.find(A=>g.selected.value.includes(A.id)))==null?void 0:f.value},set(f){q.value=f}});return Ae(()=>{const f=ze.filterProps(i);return t(ze,te({_as:"VTabsWindow"},f,{modelValue:l.value,"onUpdate:modelValue":A=>l.value=A,class:["v-tabs-window",i.class],style:i.style,mandatory:!1,touch:!1}),b)}),{}}}),va=Re({...Zt()},"VTabsWindowItem"),Ke=Ce()({name:"VTabsWindowItem",props:va(),setup(i,o){let{slots:b}=o;return Ae(()=>{const g=je.filterProps(i);return t(je,te({_as:"VTabsWindowItem"},g,{class:["v-tabs-window-item",i.class],style:i.style}),b)}),{}}});function ka(i){return i?i.map(o=>Pt(o)?o:{text:o,value:o}):[]}const ba=Re({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...ht({mandatory:"force",selectedClass:"v-tab-item--selected"}),...Ft(),...Wt()},"VTabs"),ga=Ce()({name:"VTabs",props:ba(),emits:{"update:modelValue":i=>!0},setup(i,o){let{attrs:b,slots:g}=o;const q=Ye(i,"modelValue"),l=K(()=>ka(i.items)),{densityClasses:f}=Kt(i),{backgroundColorClasses:A,backgroundColorStyles:O}=Lt(ne(i,"bgColor")),{scopeId:k}=Yt();return _t({VTab:{color:ne(i,"color"),direction:ne(i,"direction"),stacked:ne(i,"stacked"),fixed:ne(i,"fixedTabs"),sliderColor:ne(i,"sliderColor"),hideSlider:ne(i,"hideSlider")}}),Ae(()=>{const C=We.filterProps(i),y=!!(g.window||i.items.length>0);return t(N,null,[t(We,te(C,{modelValue:q.value,"onUpdate:modelValue":m=>q.value=m,class:["v-tabs",`v-tabs--${i.direction}`,`v-tabs--align-tabs-${i.alignTabs}`,{"v-tabs--fixed-tabs":i.fixedTabs,"v-tabs--grow":i.grow,"v-tabs--stacked":i.stacked},f.value,A.value,i.class],style:[{"--v-tabs-height":St(i.height)},O.value,i.style],role:"tablist",symbol:De},k,b),{default:()=>{var m;return[((m=g.default)==null?void 0:m.call(g))??l.value.map(c=>{var H;return((H=g.tab)==null?void 0:H.call(g,{item:c}))??t($e,te(c,{key:c.text,value:c.value}),{default:g[`tab.${c.value}`]?()=>{var h;return(h=g[`tab.${c.value}`])==null?void 0:h.call(g,{item:c})}:void 0})})]}}),y&&t(tt,te({modelValue:q.value,"onUpdate:modelValue":m=>q.value=m,key:"tabs-window"},k),{default:()=>{var m;return[l.value.map(c=>{var H;return((H=g.item)==null?void 0:H.call(g,{item:c}))??t(Ke,{value:c.value},{default:()=>{var h;return(h=g[`item.${c.value}`])==null?void 0:h.call(g,{item:c})}})}),(m=g.window)==null?void 0:m.call(g)]}})])}),{}}}),ha={key:0,class:"mt-4"},Va=de({__name:"TheAddReagentPopup",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:["update:modelValue"],setup(i){const o=_e(i,"modelValue"),{required:b,positive:g}=Se(),{checkName:q}=Xe(),{t:l}=ce(),f=Qe(),A=ke(),O=P(ee.FORMULA),k=P(),C=P(),y=P(),m=P(),c=P(),H=P(),h=P(),a=P(),x=P(!1);ae(()=>c.value,()=>{x.value=!1;try{a.value=new se(c.value),isNaN(a.value.mass)&&(x.value=!0)}catch{x.value=!0}},{deep:!0});function B(p){return p?"Формула введена неправильно. Правильный формат формулы CaSO4(H2O)2 или CaSO6H4.":""}const R=P([]),F=K(()=>{const p=[];for(const v of It)p.push({ion:v,conc:null});return p});function S(p){p.length>R.value.length&&typeof[...p].pop()=="string"||(R.value=p)}const U=()=>!q(c.value)||l("reagents.formulaExists"),$=()=>!q(y.value)||l("reagents.nameExists");async function G(){if(O.value===ee.FORMULA){const{valid:p}=await k.value.validate();if(!p){A.showWarning(l("common.isFormErrors"));return}f.addReagent({type:ee.FORMULA,key:c.value,name:y.value,isLiquid:m.value,density:H.value,solubility:h.value}),k.value.reset()}else if(O.value===ee.COMPOUND){const{valid:p}=await C.value.validate();if(!p){A.showWarning(l("common.isFormErrors"));return}const v={};R.value.forEach(({ion:L,conc:w})=>v[L]=w/100),f.addReagent({type:ee.COMPOUND,key:y.value,name:y.value,isLiquid:m.value,ions:v}),C.value.reset()}o.value=!1}return(p,v)=>{const L=ve;return r(),Z(Pe,{modelValue:o.value,"onUpdate:modelValue":v[10]||(v[10]=w=>o.value=w),width:"500"},{default:n(()=>[t(xe,null,{default:n(()=>[t(Te,null,{default:n(()=>[T(u(e(l)("recipes.page.reagentPopup.title")),1)]),_:1}),t(He,null,{default:n(()=>[t(ga,{modelValue:e(O),"onUpdate:modelValue":v[0]||(v[0]=w=>E(O)?O.value=w:null),"align-tabs":"center",color:"deep-purple-accent-4"},{default:n(()=>[t($e,{value:("ReagentTypeName"in p?p.ReagentTypeName:e(ee)).FORMULA},{default:n(()=>[T(u(e(l)("common.formula")),1)]),_:1},8,["value"]),t($e,{value:("ReagentTypeName"in p?p.ReagentTypeName:e(ee)).COMPOUND},{default:n(()=>[T(u(e(l)("common.compound")),1)]),_:1},8,["value"])]),_:1},8,["modelValue"]),t(tt,{modelValue:e(O),"onUpdate:modelValue":v[8]||(v[8]=w=>E(O)?O.value=w:null)},{default:n(()=>[t(Ke,{value:("ReagentTypeName"in p?p.ReagentTypeName:e(ee)).FORMULA},{default:n(()=>[t(fe,{ref_key:"reagentFormulaFormRef",ref:k},{default:n(()=>[t(Ve,{modelValue:e(c),"onUpdate:modelValue":v[1]||(v[1]=w=>E(c)?c.value=w:null),label:e(l)("recipes.page.reagentPopup.formulaInput"),variant:"underlined",error:e(x),"error-messages":B(e(x)),rules:[e(b),U],"hide-details":"auto"},null,8,["modelValue","label","error","error-messages","rules"]),e(a)!==void 0?(r(),V("div",ha,[(r(!0),V(N,null,J(Object.entries(e(a).fraction),([w,X])=>(r(),V("span",{key:w},u(w)+": "+u(("format"in p?p.format:e(Y))(X*100))+"% ",1))),128))])):D("",!0),t(ye,{modelValue:e(m),"onUpdate:modelValue":v[2]||(v[2]=w=>E(m)?m.value=w:null),inline:"",color:"primary",class:"mt-3 ml-n2","hide-details":"auto",rules:[e(b)]},{default:n(()=>[t(j,{label:e(l)("common.dry"),value:!1},null,8,["label"]),t(j,{label:e(l)("common.liquid"),value:!0,class:"ml-2"},null,8,["label"])]),_:1},8,["modelValue","rules"]),t(ie,null,{default:n(()=>[e(m)?(r(),Z(L,{key:0,modelValue:e(H),"onUpdate:modelValue":v[3]||(v[3]=w=>E(H)?H.value=w:null),suffix:e(l)("recipes.page.reagentPopup.densityUnit"),label:e(l)("recipes.page.reagentPopup.densityInput"),hint:e(l)("recipes.page.reagentPopup.densityHint"),rules:[e(b)]},null,8,["modelValue","suffix","label","hint","rules"])):D("",!0)]),_:1}),t(Ve,{modelValue:e(y),"onUpdate:modelValue":v[4]||(v[4]=w=>E(y)?y.value=w:null),label:e(l)("recipes.page.reagentPopup.reagentName"),variant:"underlined",rules:[e(b),$]},null,8,["modelValue","label","rules"]),t(ie,null,{default:n(()=>[e(m)?D("",!0):(r(),Z(L,{key:0,modelValue:e(h),"onUpdate:modelValue":v[5]||(v[5]=w=>E(h)?h.value=w:null),label:e(l)("recipes.page.reagentPopup.reagentSolubilityInput"),hint:e(l)("recipes.page.reagentPopup.reagentSolubilityHint")},null,8,["modelValue","label","hint"]))]),_:1})]),_:1},512)]),_:1},8,["value"]),t(Ke,{value:("ReagentTypeName"in p?p.ReagentTypeName:e(ee)).COMPOUND},{default:n(()=>[t(fe,{ref_key:"reagentCompoundFormRef",ref:C},{default:n(()=>[t(Ve,{modelValue:e(y),"onUpdate:modelValue":v[6]||(v[6]=w=>E(y)?y.value=w:null),label:e(l)("recipes.page.reagentPopup.reagentName"),variant:"underlined",rules:[e(b),$]},null,8,["modelValue","label","rules"]),t(ye,{modelValue:e(m),"onUpdate:modelValue":v[7]||(v[7]=w=>E(m)?m.value=w:null),inline:"",color:"primary",class:"ml-n2","hide-details":"auto",rules:[e(b)]},{default:n(()=>[t(j,{label:e(l)("common.dry"),value:!1},null,8,["label"]),t(j,{label:e(l)("common.liquid"),value:!0,class:"ml-2"},null,8,["label"])]),_:1},8,["modelValue","rules"]),t(Je,{"model-value":e(R),items:e(F),"item-title":"ion",variant:"underlined",label:e(l)("fertilizers.page.ionsInput"),hint:e(l)("fertilizers.page.ionsInputHint"),"persistent-hint":"","hide-details":"auto",multiple:"",chips:"","closable-chips":"",rules:[e(b)],class:"mb-4","onUpdate:modelValue":S},null,8,["model-value","items","label","hint","rules"]),(r(!0),V(N,null,J(e(R),w=>(r(),Z(L,{key:w.ion,modelValue:w.conc,"onUpdate:modelValue":X=>w.conc=X,label:w.ion,suffix:"%",variant:"underlined","persistent-placeholder":"",placeholder:"0","hide-details":"auto",rules:[e(b),e(g)],class:"mb-2"},null,8,["modelValue","onUpdate:modelValue","label","rules"]))),128))]),_:1},512)]),_:1},8,["value"])]),_:1},8,["modelValue"])]),_:1}),t(Ne),t(Me,null,{default:n(()=>[t(W,{variant:"text",onClick:v[9]||(v[9]=w=>o.value=!1)},{default:n(()=>[T(u(e(l)("buttons.close")),1)]),_:1}),t(qe),t(W,{color:"primary",variant:"text",onClick:G},{default:n(()=>[T(u(e(l)("buttons.save")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),wa={class:"mb-4"},Oa={class:"mt-4"},Ca={class:"d-flex align-center"},Ra=de({name:"TheAddTrilonBPopup",__name:"TheAddTrilonBPopup",props:ue({recipe:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:ue(["save"],["update:modelValue"]),setup(i,{emit:o}){const b=_e(i,"modelValue"),g=i,q=o;Se();const{t:l}=ce(),f=ke(),A=P(),O=P(0),k=P(),C=P([]);ae([C,k],()=>{let m=0;const c=new se(re).mass;C.value.forEach(H=>{const h=g.recipe.reagents.find(a=>a.key===H);h&&(m+=h.amount*c/new se(H).mass),(h==null?void 0:h.key)==="Fe2(SO4)3(H2O)9"&&(m*=2)}),k.value&&(m*=(100+k.value)/100),O.value=Y(m)});async function y(){const{valid:m}=await A.value.validate();if(!m){f.showWarning(l("common.isFormErrors"));return}q("save",O.value),b.value=!1}return(m,c)=>{const H=ve;return r(),Z(Pe,{modelValue:b.value,"onUpdate:modelValue":c[5]||(c[5]=h=>b.value=h),width:"500"},{default:n(()=>[t(xe,null,{default:n(()=>[t(Te,null,{default:n(()=>[T(u(e(l)("recipes.page.trilonPopup.title")),1)]),_:1}),t(He,null,{default:n(()=>[t(fe,{ref_key:"chelatorFormRef",ref:A},{default:n(()=>[M("div",wa,u(e(l)("recipes.page.trilonPopup.hint")),1),(r(!0),V(N,null,J(m.recipe.reagents,h=>(r(),V("div",{key:h.key,class:"d-flex align-center"},[["TrilonB"in m?m.TrilonB:e(re),"EDTA"in m?m.EDTA:e(me),"H2O"].includes(h.key)?D("",!0):(r(),V(N,{key:0},[t(H,{"model-value":h.amount,label:h.text,suffix:h.isLiquid?e(l)("units.ml"):e(l)("units.g"),"hide-details":"auto",class:"mb-2 mb-sm-4",readonly:""},null,8,["model-value","label","suffix"]),t(et,{modelValue:e(C),"onUpdate:modelValue":c[0]||(c[0]=a=>E(C)?C.value=a:null),value:h.key,class:"ml-2"},null,8,["modelValue","value"])],64))]))),128)),M("div",Oa,u(e(l)("recipes.page.trilonPopup.chelatorIncrease")),1),M("div",Ca,[t(ye,{modelValue:e(k),"onUpdate:modelValue":c[1]||(c[1]=h=>E(k)?k.value=h:null),inline:"",color:"primary",class:"mt-3 ml-n2","hide-details":"auto"},{default:n(()=>[t(j,{label:"5%",value:5}),t(j,{label:"10%",value:10}),t(j,{label:"15%",value:15})]),_:1},8,["modelValue"]),t(H,{modelValue:e(k),"onUpdate:modelValue":c[2]||(c[2]=h=>E(k)?k.value=h:null),label:e(l)("recipes.page.trilonPopup.anotherValue"),suffix:"%","hide-details":"auto"},null,8,["modelValue","label"])]),t(H,{modelValue:e(O),"onUpdate:modelValue":c[3]||(c[3]=h=>E(O)?O.value=h:null),label:e(l)("recipes.page.trilonPopup.trilonAmount"),suffix:e(l)("units.g"),variant:"outlined","hide-details":"auto",class:"mt-10"},null,8,["modelValue","label","suffix"])]),_:1},512)]),_:1}),t(Ne),t(Me,null,{default:n(()=>[t(W,{variant:"text",onClick:c[4]||(c[4]=h=>b.value=!1)},{default:n(()=>[T(u(e(l)("buttons.cancel")),1)]),_:1}),t(qe),t(W,{color:"primary",variant:"text",onClick:y},{default:n(()=>[T(u(e(l)("buttons.save")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),_a={class:"mb-4"},Sa={class:"mt-4"},Pa={class:"d-flex align-center"},Ta={class:"mt-4 mb-6"},Ha={class:"d-flex align-center"},Ma=de({name:"TheAddEDTAPopup",__name:"TheAddEDTAPopup",props:ue({recipe:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:ue(["save"],["update:modelValue"]),setup(i,{emit:o}){const b=_e(i,"modelValue"),g=i,q=o;Se();const{t:l}=ce(),f=ke(),A=P(),O=P(0),k=P(),C=P(4),y=P("KOH"),m=P(0),c=["NaOH","KOH","K2CO3"],H=P([]);ae([H,k,C,y],()=>{let a=0;const x=new se(me).mass;H.value.forEach(R=>{const F=g.recipe.reagents.find(S=>S.key===R);F&&(a+=F.amount*x/new se(R).mass),(F==null?void 0:F.key)==="Fe2(SO4)3(H2O)9"&&(a*=2)}),k.value&&(a*=(100+k.value)/100),O.value=Y(a);const B=a/x;m.value=Y(B*new se(y.value).mass*C.value)}),ae(y,a=>{["NaOH","KOH"].includes(a)?C.value=4:a==="K2CO3"&&(C.value=2)});async function h(){const{valid:a}=await A.value.validate();if(!a){f.showWarning(l("common.isFormErrors"));return}q("save",O.value,m.value,y.value),b.value=!1}return(a,x)=>{const B=ve;return r(),Z(Pe,{modelValue:b.value,"onUpdate:modelValue":x[6]||(x[6]=R=>b.value=R),width:"500"},{default:n(()=>[t(xe,null,{default:n(()=>[t(Te,null,{default:n(()=>[T(u(e(l)("recipes.page.edtaPopup.title")),1)]),_:1}),t(He,null,{default:n(()=>[t(fe,{ref_key:"chelatorFormRef",ref:A},{default:n(()=>[M("div",_a,u(e(l)("recipes.page.edtaPopup.hint")),1),(r(!0),V(N,null,J(a.recipe.reagents,R=>(r(),V("div",{key:R.key,class:"d-flex align-center"},[["TrilonB"in a?a.TrilonB:e(re),"EDTA"in a?a.EDTA:e(me),"H2O"].includes(R.key)?D("",!0):(r(),V(N,{key:0},[t(B,{"model-value":R.amount,label:R.text,suffix:R.isLiquid?e(l)("units.ml"):e(l)("units.g"),"hide-details":"auto",class:"mb-2 mb-sm-4",readonly:""},null,8,["model-value","label","suffix"]),t(et,{modelValue:e(H),"onUpdate:modelValue":x[0]||(x[0]=F=>E(H)?H.value=F:null),value:R.key,class:"ml-2"},null,8,["modelValue","value"])],64))]))),128)),M("div",Sa,u(e(l)("recipes.page.edtaPopup.chelatorIncrease")),1),M("div",Pa,[t(ye,{modelValue:e(k),"onUpdate:modelValue":x[1]||(x[1]=R=>E(k)?k.value=R:null),inline:"",color:"primary",class:"mt-3 ml-n2","hide-details":"auto"},{default:n(()=>[t(j,{label:"5%",value:5}),t(j,{label:"10%",value:10}),t(j,{label:"15%",value:15})]),_:1},8,["modelValue"]),t(B,{modelValue:e(k),"onUpdate:modelValue":x[2]||(x[2]=R=>E(k)?k.value=R:null),label:e(l)("recipes.page.edtaPopup.anotherValue"),suffix:"%","hide-details":"auto"},null,8,["modelValue","label"])]),t(B,{"model-value":e(O),label:e(l)("recipes.page.edtaPopup.edtaAmount"),suffix:e(l)("units.g"),variant:"outlined","hide-details":"auto",class:"mt-10",readonly:""},null,8,["model-value","label","suffix"]),M("div",Ta,u(e(l)("recipes.page.edtaPopup.alkaliHint")),1),M("div",Ha,[t(Vt,{modelValue:e(y),"onUpdate:modelValue":x[3]||(x[3]=R=>E(y)?y.value=R:null),items:c,label:e(l)("recipes.page.edtaPopup.alkaliSelect"),"hide-selected":"","hide-details":"auto",variant:"outlined",class:"w-50"},null,8,["modelValue","label"]),t(ye,{modelValue:e(C),"onUpdate:modelValue":x[4]||(x[4]=R=>E(C)?C.value=R:null),inline:"",color:"primary",class:"ml-2","hide-details":"auto"},{default:n(()=>[t(j,{label:"1",value:1}),t(j,{label:"2",value:2}),e(y)!=="K2CO3"?(r(),V(N,{key:0},[t(j,{label:"3",value:3}),t(j,{label:"4",value:4})],64)):D("",!0)]),_:1},8,["modelValue"])]),t(B,{"model-value":e(m),label:e(l)("recipes.page.edtaPopup.alkaliAmount"),suffix:e(l)("units.g"),variant:"outlined","hide-details":"auto",class:"mt-10",readonly:""},null,8,["model-value","label","suffix"])]),_:1},512)]),_:1}),t(Ne),t(Me,null,{default:n(()=>[t(W,{variant:"text",onClick:x[5]||(x[5]=R=>b.value=!1)},{default:n(()=>[T(u(e(l)("buttons.cancel")),1)]),_:1}),t(qe),t(W,{color:"primary",variant:"text",onClick:h},{default:n(()=>[T(u(e(l)("buttons.save")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),xa={class:"text-grey-darken-1 mb-4"},Aa={key:0},Na={class:"font-weight-medium mb-2"},qa={class:"d-flex flex-wrap"},Ea={class:"font-weight-medium mr-1"},Ua=de({name:"TheUnitConcPopup",__name:"TheUnitConcPopup",props:ue({recipe:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:ue(["save"],["update:modelValue"]),setup(i,{emit:o}){const{t:b}=ce(),g=Qt(),q=ke(),l=_e(i,"modelValue"),f=i,A=o,O=[Oe,me,re],k=P({}),C=P({}),y=P(),m=g.tankModels.map(S=>S.toJson()),c=K(()=>f.recipe.reagents.filter(S=>!O.includes(S.key))),H=K(()=>c.value.length>0);ae(l,S=>{S&&f.recipe.tankVolume&&(y.value={name:f.recipe.tankVolume.toString(),volume:f.recipe.tankVolume})}),ae(y,()=>{k.value=f.recipe.countRecipeUnitConcsByAmounts()});const h=K(()=>f.recipe.countRecipeIonUnitConcs(k.value)),a=K(()=>{const S=Ie(h.value);return S.sort((U,$)=>$[1]-U[1]),S}),x=K(()=>ea(h.value).reduce((S,U)=>S+U,0));function B(S){typeof S=="number"?(y.value={name:S.toString(),volume:S},f.recipe.tankVolume=+S):(y.value=S,f.recipe.tankVolume=S.volumeTotal),f.recipe.countRecipeUnitConcsByAmounts()}function R(S,U,$){const G=f.recipe.countReagentAmountByUnitConc(S,U,$);C.value[U.key]=G,Ie(U.ions).forEach(([p,v])=>{const L=U.density??1;($===""||$!==p)&&(k.value[U.key][p]=Y(G/f.recipe.totalVolume/y.value.volume*v*1e3*L))})}async function F(){A("save",C.value),l.value=!1,q.show("Новые значения масс реагентов сохранены")}return(S,U)=>{const $=Xt,G=ve;return r(),Z(Pe,{modelValue:l.value,"onUpdate:modelValue":U[2]||(U[2]=p=>l.value=p),width:"500"},{default:n(()=>[t(xe,null,{default:n(()=>[t(Te,null,{default:n(()=>[T(u(e(b)("recipes.page.unitConcPopup.title")),1)]),_:1}),t(He,null,{default:n(()=>[M("div",xa,[T(u(e(b)("recipes.page.unitConcPopup.hint"))+" ",1),t(ta,{location:"bottom","max-width":"400","open-on-click":"","open-on-hover":""},{activator:n(({props:p})=>[t($,te({name:"mdi-help-circle-outline",size:"18"},p),null,16)]),default:n(()=>[T(" "+u(e(b)("recipes.page.unitConcDescription")),1)]),_:1})]),t(Je,{modelValue:e(y),"onUpdate:modelValue":[U[0]||(U[0]=p=>E(y)?y.value=p:null),B],modelModifiers:{number:!0},items:e(m),"item-title":"name",variant:"underlined",label:e(b)("recipes.page.tankInputLabel"),"persistent-hint":"","hide-selected":"",suffix:e(b)("units.l")},null,8,["modelValue","items","label","suffix"]),t(ie,null,{default:n(()=>[S.recipe.tankVolume?(r(),V("div",Aa,[(r(!0),V(N,null,J(e(c),p=>(r(),Z(Be,{key:p.key,class:"mb-3"},{default:n(()=>[t(we,{cols:"12",class:"font-weight-regular pb-1"},{default:n(()=>[T(u(p.text),1)]),_:2},1024),(r(!0),V(N,null,J(p.ions,(v,L)=>(r(),Z(we,{key:p.key+L,cols:p.ionsTotal>=2?"6":"",sm:p.ionsTotal>3?"4":"",class:"py-0"},{default:n(()=>[t(G,{modelValue:e(k)[p.key][L],"onUpdate:modelValue":[w=>e(k)[p.key][L]=w,w=>R(w,p,L)],modelModifiers:{number:!0},label:L,suffix:e(b)("units.mg/l / ml"),"hide-details":"auto"},null,8,["modelValue","onUpdate:modelValue","label","suffix"])]),_:2},1032,["cols","sm"]))),128))]),_:2},1024))),128)),e(H)?(r(),Z(Be,{key:0},{default:n(()=>[t(we,{cols:"12"},{default:n(()=>[M("div",Na,u(e(b)("common.total"))+", "+u(e(b)("units.mg/l / ml"))+": ",1),M("div",qa,[(r(!0),V(N,null,J(e(a),([p,v])=>(r(),V("div",{key:p,class:"d-flex justify-space-between mr-2"},[M("div",Ea,u(p)+":",1),M("div",null,u(("format"in S?S.format:e(Y))(v))+" ("+u(("format"in S?S.format:e(Y))(v/e(x)*100))+"%) ",1)]))),128))])]),_:1})]),_:1})):D("",!0)])):D("",!0)]),_:1})]),_:1}),t(Ne),t(Me,null,{default:n(()=>[t(W,{variant:"text",onClick:U[1]||(U[1]=p=>l.value=!1)},{default:n(()=>[T(u(e(b)("buttons.close")),1)]),_:1}),t(qe),t(W,{color:"primary",variant:"text",onClick:F},{default:n(()=>[T(u(e(b)("buttons.save")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Fe=[{key:"kubanNitrate",name:"Kuban Aquariums Нитрат",reagents:[{key:"H2O",amount:1e3},{key:"KNO3",amount:49.71},{key:"(NH2)2CO",amount:5.02},{key:"NH4NO3",amount:6.71},{key:"C6H7KO2",amount:.5}],tankVolume:100,description:"Рецепт взят с youtube канала Kuban Aquariums (https://www.youtube.com/watch?v=Vyq-R0tv384)"},{key:"kubanPhosphate",name:"Kuban Aquariums Фосфат",reagents:[{key:"H2O",amount:1e3},{key:"KH2PO4",amount:7.01},{key:"C6H7KO2",amount:.5}],tankVolume:100,description:"Рецепт взят с youtube канала Kuban Aquariums (https://www.youtube.com/watch?v=Vyq-R0tv384)"},{key:"kubanPotassium",name:"Kuban Aquariums Калий",reagents:[{key:"H2O",amount:1e3},{key:"K2SO4",amount:84.76},{key:"C6H7KO2",amount:.5}],tankVolume:100,description:"Рецепт взят с youtube канала Kuban Aquariums (https://www.youtube.com/watch?v=Vyq-R0tv384)"},{key:"kubanMicro",name:"Kuban Aquariums Микро",reagents:[{key:"H2O",amount:1e3},{key:"AgroMicsT",amount:11},{key:"Fe-EDTA13",amount:5.6},{key:"MgSO4(H2O)7",amount:30},{key:"K2SO4",amount:20},{key:"H3BO3",amount:.7},{key:"C6H8O6",amount:.1},{key:"C6H7KO2",amount:.5},{key:"C10H14N2Na2O8(H2O)2",amount:3}],tankVolume:100,description:"Рецепт взят с youtube канала Kuban Aquariums (https://www.youtube.com/watch?v=Vyq-R0tv384)"},{key:"botanicNitrate",name:"Aqua Botanic Нитрат",reagents:[{key:"H2O",amount:1e3},{key:"KNO3",amount:82.88}],tankVolume:100,description:"Чистая калиевая селитра. Рецепт взят с сайта aqua-botanic.ru(https://web.archive.org/web/20131206073940/http://www.aqua-botanic.ru/index.html)"},{key:"botanicNitratePlus",name:"Aqua Botanic Нитрат+",reagents:[{key:"H2O",amount:1e3},{key:"KNO3",amount:49.71},{key:"(NH2)2CO",amount:5.02},{key:"NH4NO3",amount:6.71}],tankVolume:100,description:"Калиевая селитра, разбавленная мочевиной и нитратом аммония. Рецепт взят с сайта aqua-botanic.ru(https://web.archive.org/web/20131206073940/http://www.aqua-botanic.ru/index.html)"},{key:"botanicPhosphate",name:"Aqua Botanic Фосфат",reagents:[{key:"H2O",amount:1e3},{key:"KH2PO4",amount:7.01}],tankVolume:100,description:"Чистый монофосфат калия. Рецепт взят с сайта aqua-botanic.ru(https://web.archive.org/web/20131206073940/http://www.aqua-botanic.ru/index.html)"},{key:"botanicPotassium",name:"Aqua Botanic Калий",reagents:[{key:"H2O",amount:1e3},{key:"K2SO4",amount:84.76}],tankVolume:100,description:"Чистый сульфат калия. Рецепт взят с сайта aqua-botanic.ru(https://web.archive.org/web/20131206073940/http://www.aqua-botanic.ru/index.html)"},{key:"botanicMicro",name:"Aqua Botanic Микро",reagents:[{key:"H2O",amount:968},{key:"C6H8O7",amount:30},{key:"FeSO4(H2O)7",amount:10},{key:"MnSO4(H2O)5",amount:.5},{key:"CuSO4(H2O)5",amount:.05},{key:"ZnSO4(H2O)7",amount:.6},{key:"MgSO4(H2O)7",amount:10.54},{key:"H3BO3",amount:.3},{key:"K2SO4",amount:8.6},{key:"C63H88CoN14O14P",amount:.001},{key:"Citovit",amount:6},{key:"Ferovit",amount:6},{key:"H2SO4",amount:20}],tankVolume:100,description:`Рецепт взят с сайта aqua-botanic.ru
(https://web.archive.org/web/20131206073940/http://www.aqua-botanic.ru/index.html):

С помощью мерного стакана отмеряем 700 мл дистиллированной воды или воды из фильтра с обратным осмосом.
Воду предварительно кипятим и растворяем

* Лимонную кислоту 30 грамм
* Сульфат железа - 10 грамм
* Сульфат марганца - 0.5 грамм
* Сульфат меди - 0.05 грамм
* Сульфат цинка - 0.6 грамм
* Сульфат магния - 10.54 грамма
* сделать паузу в 1 час.
* Борная кислота - 0.3 грамма
* Сульфат калия - 8.6 грамма
* Цитовит 4 ампулы
* Феровит - 4 ампулы
* Витамин B12 2 ампулы
* Серная кислота - 20 мл.

Важно! Можно вливать только кислоту в воду, а не наоборот.
При желании, серную кислоту можно заменить на Сайдекс (2.5% раствор глутарового альдегида) в
количестве 200-250 мл. Долить воду в раствор с удобрением до отметки 1 литр. Воду можно не кипятить.

Растворять каждый последующий реактив можно только после того, как полностью растворится предыдущий.`},{key:"amaniaNpk",name:"NPK Amania.org 1:15",reagents:[{key:"H2O",amount:1e3},{key:"KNO3",amount:106.45},{key:"KH2PO4",amount:5.77}],tankVolume:100,description:"Макро в соотношении 1 к 15. Рецепт взят с сайта amania.org"},{key:"amaniaNpkPlus",name:"NPK Amania.org 1:15 + амидный азот",reagents:[{key:"H2O",amount:1e3},{key:"KNO3",amount:53.6},{key:"(NH2)2CO",amount:16},{key:"KH2PO4",amount:5.77}],tankVolume:100,description:"Макро в соотношении 1 к 15. Калиевая селитра в соотношении 50 на 50 с мочевиной. Рецепт взят с сайта amania.org"},{key:"ermolaevMicro",name:"Удо Ермолаева. МИКРО",reagents:[{key:"H2O",amount:500},{key:"K2SO4",amount:7.45},{key:"MgSO4(H2O)7",amount:16.4},{key:"Fe2(SO4)3(H2O)9",amount:1.45},{key:"CuSO4(H2O)5",amount:.1},{key:"ZnSO4(H2O)7",amount:.04},{key:"H3BO3",amount:.1},{key:"(NH4)2MoO4",amount:.04},{key:"MnSO4(H2O)5",amount:.73},{key:"C10H14N2Na2O8(H2O)2",amount:2.5}],tankVolume:100,description:"Микро. Рецепт - https://aquascape-promotion.com/udobreniya-svoimi-rukami"},{key:"ermolaevMikroGh7",name:"Удо Ермолаева. МИКРО (gh < 7)",reagents:[{key:"H2O",amount:500},{key:"K2SO4",amount:7.45},{key:"MgSO4(H2O)7",amount:16.4},{key:"Fe2(SO4)3(H2O)9",amount:1.45},{key:"CuSO4(H2O)5",amount:.1},{key:"ZnSO4(H2O)7",amount:.04},{key:"H3BO3",amount:.1},{key:"(NH4)2MoO4",amount:.04},{key:"MnSO4(H2O)5",amount:.73},{key:"C10H14N2Na2O8(H2O)2",amount:1.75}],tankVolume:100,description:"Микро. Рецепт - https://aquascape-promotion.com/udobreniya-svoimi-rukami"},{key:"ermolaevMicroFeSulphate",name:"Удо Ермолаева. МИКРО (Железный купорос)",reagents:[{key:"H2O",amount:500},{key:"K2SO4",amount:7.45},{key:"MgSO4(H2O)7",amount:16.4},{key:"FeSO4(H2O)7",amount:1.44},{key:"CuSO4(H2O)5",amount:.1},{key:"ZnSO4(H2O)7",amount:.04},{key:"H3BO3",amount:.1},{key:"(NH4)2MoO4",amount:.04},{key:"MnSO4(H2O)5",amount:.73},{key:"C14H18N3O10Na2Fe",amount:1},{key:"C10H14N2Na2O8(H2O)2",amount:1.75}],tankVolume:100,description:"Микро. Рецепт - https://aquascape-promotion.com/udobreniya-svoimi-rukami"},{key:"ppsProMacro",name:"Pps-pro Macro",reagents:[{key:"H2O",amount:500},{key:"K2SO4",amount:29.3},{key:"KNO3",amount:32.6},{key:"KH2PO4",amount:2.9},{key:"MgSO4(H2O)7",amount:20.2}],description:"Рецепт взят с сайта https://sites.google.com/site/aquaticplantfertilizer/pps-pro. Методика там же"},{key:"ppsProMicro",name:"Pps-pro Micro",reagents:[{key:"H2O",amount:500},{key:"PlantexCMM",amount:28.6}],description:"Рецепт взят с сайта https://sites.google.com/site/aquaticplantfertilizer/pps-pro. Методика там же"},{key:"pmddCmm",name:"PMDD CMM",reagents:[{key:"H2O",amount:500},{key:"K2SO4",amount:33},{key:"KNO3",amount:15},{key:"MgSO4(H2O)7",amount:15},{key:"PlantexCMM",amount:9.93}],description:"http://www.amania.org/Tech/liqfert-mikom.html"},{key:"pmddCsm",name:"PMDD CSM + B",reagents:[{key:"H2O",amount:500},{key:"K2SO4",amount:33},{key:"KNO3",amount:15},{key:"MgSO4(H2O)7",amount:15},{key:"H3BO3",amount:.714},{key:"PlantexCSM",amount:9.93}],description:"http://www.amania.org/Tech/liqfert-mikom.html"},{key:"udarMacro",name:"Удар Макро",reagents:[{key:"H2O",amount:1e3},{key:"KNO3",amount:82},{key:"KH2PO4",amount:7},{key:"C6H7KO2",amount:.5}],description:"Это удобрение от Юрия Христенко (https://www.youtube.com/@Echinodorus)"},{key:"udarMicro",name:"Удар Микро",reagents:[{key:"H2O",amount:1e3},{key:"AgroMicsT",amount:11},{key:"Fe-EDTA13",amount:5.6},{key:"K2SO4",amount:20},{key:"MgSO4(H2O)7",amount:30},{key:"H3BO3",amount:.7},{key:"C6H8O6",amount:3},{key:"C6H7KO2",amount:.5},{key:"C10H14N2Na2O8(H2O)2",amount:3}],description:"Это удобрение от Юрия Христенко (https://www.youtube.com/@Echinodorus)"}];Fe.sort((i,o)=>i.name.localeCompare(o.name));const Ia=[{key:"kubanNitrate",name:"Kuban Aquariums Nitrate",description:"Recipe taken from Kuban Aquariums YouTube channel (https://www.youtube.com/watch?v=Vyq-R0tv384)"},{key:"kubanPhosphate",name:"Kuban Aquariums Phosphate",description:"Recipe taken from Kuban Aquariums YouTube channel (https://www.youtube.com/watch?v=Vyq-R0tv384)"},{key:"kubanPotassium",name:"Kuban Aquariums Potassium",description:"Recipe taken from Kuban Aquariums YouTube channel (https://www.youtube.com/watch?v=Vyq-R0tv384)"},{key:"kubanMicro",name:"Kuban Aquariums Micro",description:"Recipe taken from Kuban Aquariums YouTube channel (https://www.youtube.com/watch?v=Vyq-R0tv384)"},{key:"botanicNitrate",name:"Aqua Botanic Nitrate",description:"Pure potassium nitrate. Recipe taken from aqua-botanic.ru website (https://web.archive.org/web/20131206073940/http://www.aqua-botanic.ru/index.html)"},{key:"botanicNitratePlus",name:"Aqua Botanic Nitrate+",description:"Potassium nitrate diluted with urea and ammonium nitrate. Recipe taken from aqua-botanic.ru website (https://web.archive.org/web/20131206073940/http://www.aqua-botanic.ru/index.html)"},{key:"botanicPhosphate",name:"Aqua Botanic Phosphate",description:"Pure monopotassium phosphate. Recipe taken from aqua-botanic.ru website (https://web.archive.org/web/20131206073940/http://www.aqua-botanic.ru/index.html)"},{key:"botanicPotassium",name:"Aqua Botanic Potassium",description:"Pure potassium sulfate. Recipe taken from aqua-botanic.ru website (https://web.archive.org/web/20131206073940/http://www.aqua-botanic.ru/index.html)"},{key:"botanicMicro",name:"Aqua Botanic Micro",description:`Recipe taken from aqua-botanic.ru website
(https://web.archive.org/web/20131206073940/http://www.aqua-botanic.ru/index.html):

Using a measuring cup, measure 700 ml of distilled water or reverse osmosis filtered water.
Pre-boil the water and dissolve:

* Citric acid 30 grams
* Iron sulfate - 10 grams
* Manganese sulfate - 0.5 grams
* Copper sulfate - 0.05 grams
* Zinc sulfate - 0.6 grams
* Magnesium sulfate - 10.54 grams
* take a 1-hour break
* Boric acid - 0.3 grams
* Potassium sulfate - 8.6 grams
* Citovit 4 ampoules
* Ferovit - 4 ampoules
* Vitamin B12 2 ampoules
* Sulfuric acid - 20 ml

Important! Only add acid to water, never the other way around.
If desired, sulfuric acid can be replaced with Cidex (2.5% glutaraldehyde solution) in
the amount of 200-250 ml. Add water to the fertilizer solution up to the 1 liter mark. Water doesn't need to be boiled.

Each subsequent reagent should only be dissolved after the previous one has completely dissolved.`},{key:"amaniaNpk",name:"NPK Amania.org 1:15",description:"Macro in a 1 to 15 ratio. Recipe taken from amania.org website"},{key:"amaniaNpkPlus",name:"NPK Amania.org 1:15 + amide nitrogen",description:"Macro in a 1 to 15 ratio. Potassium nitrate in a 50-50 ratio with urea. Recipe taken from amania.org website"},{key:"ermolaevMicro",name:"Udo Ermolaev. MICRO",description:"Micro fertilizer. Recipe - https://aquascape-promotion.com/udobreniya-svoimi-rukami"},{key:"ermolaevMikroGh7",name:"Udo Ermolaev. MICRO (gh < 7)",description:"Micro fertilizer. Recipe - https://aquascape-promotion.com/udobreniya-svoimi-rukami"},{key:"ermolaevMicroFeSulphate",name:"Udo Ermolaev. MICRO (Iron Sulfate)",description:"Micro fertilizer. Recipe - https://aquascape-promotion.com/udobreniya-svoimi-rukami"},{key:"ppsProMacro",name:"PPS-Pro Macro",description:"Recipe taken from https://sites.google.com/site/aquaticplantfertilizer/pps-pro. Methodology available there"},{key:"ppsProMicro",name:"PPS-Pro Micro",description:"Recipe taken from https://sites.google.com/site/aquaticplantfertilizer/pps-pro. Methodology available there"},{key:"pmddCmm",name:"PMDD CMM",description:"http://www.amania.org/Tech/liqfert-mikom.html"},{key:"pmddCsm",name:"PMDD CSM + B",description:"http://www.amania.org/Tech/liqfert-mikom.html"},{key:"udarMacro",name:"Udar Macro",description:"This fertilizer is by Yuri Khristenko (https://www.youtube.com/@Echinodorus)"},{key:"udarMicro",name:"Udar Micro",description:"This fertilizer is by Yuri Khristenko (https://www.youtube.com/@Echinodorus)"}],Ba={class:"text-h6 text-sm-h5"},$a={class:"text-subtitle-1"},Ka={class:"text-h6 text-sm-h5"},Fa={class:"text-subtitle-1"},Da={class:"text-body-2 text-grey-darken-1 mb-2"},La={key:0},Wa={key:0,class:"text-grey-darken-1 mt-6 mb-4"},za={class:"mt-2 mt-sm-4 text-body-2"},ja={key:0},Ga={key:0,style:{width:"100px"}},Ja={key:0,class:"d-flex justify-end mt-4"},Za={key:0,class:"mt-8"},Ya={key:1},Xa={class:"d-flex mt-10"},Ge=0,Qa=de({__name:"[id]",setup(i){const{t:o,locale:b}=ce(),{appRoutes:g}=oa(),{required:q,positive:l}=Se(),f=xt(),A=Mt(),O=ke(),k=Qe(),C=na(),y=[...Fe];b.value==="en"&&Ia.forEach(s=>{const d=y.find(I=>s.key===I.key);d&&(d.name=s.name,d.description=s.description)});const{getReagents:m}=Xe();let c=m(Ge);const H=P(null),h=P(null),a=Tt(new la({name:"",description:"",tankVolume:null,reagents:[]}));ae(()=>a.reagents,()=>{if(!a.name&&a.reagents.length>1){const s=a.reagents[1];a.name=s.text}}),ae(()=>k.reagents,()=>{c=m(Ge)},{deep:!0});function x(s){s.length>a.reagents.length&&typeof[...s].pop()=="string"||(a.reagents=s)}function B(s){a.name=s.name,a.description=s.description,a.tankVolume=s.tankVolume}const R=s=>{typeof s=="string"||s===null||(h.value=s,a.reagents=[],s.reagents.forEach(({key:d,amount:I})=>{const z=c.find(Q=>Q.key===d);z&&(z.amount=I,a.reagents.push(z))}),B(s))};function F(s,d){d.amount=s,a.setReagentAmount(s,d.key)}function S(s,d){d.dilution=s}function U(s){const d=s-(a.totalVolume-a.waterVolume);a.setReagentAmount(d,"H2O")}const{checkName:$}=sa(),G=P(!1),p=C.fertilizerRecipeModels,v=K(()=>A.params.id==="create"),L=K(()=>A.params.id!=="create"),w=K(()=>A.query.copy!==void 0),X=K(()=>A.query.share!==void 0),le=K(()=>+A.params.id),oe=P(!1),be=P(!1),ge=P(!1),he=P(!1),at=K(()=>$(a.name)&&!L.value),ot=()=>!at.value||o("recipes.page.nameExists"),nt=s=>a.isLiquid&&s.amount/a.totalVolume*1e3>s.solubility,lt=s=>a.isLiquid&&s.amount/a.totalVolume*1e3>s.solubility?`${o("validation.solubilityLimit")} - ${s.solubility} ${o("units.g/l")} ${o("common.for")} 25°С!`:"";if(v.value){const s=c.find(d=>d.key===Oe);s.amount=500,a.reagents.push(s)}Ht(async()=>{if(v.value&&!w.value)return;let s;if(X.value)[s]=JSON.parse(decodeURIComponent(A.query.share));else if(w.value){const I=A.query.copy;s=JSON.parse(JSON.stringify({...p[+I]}))}else v.value||(s=JSON.parse(JSON.stringify({...p[le.value]})));if(Object.keys(s).length===0){await f.push(g.value.recipes.path);return}const d={};s.reagents.forEach(I=>{d[I.key]=I}),c.forEach(I=>{I.key in d&&(I.amount=d[I.key].amount,I.dilution=d[I.key].dilution,a.reagents.push(I))}),B(s)});async function st(){const{valid:s}=await H.value.validate();if(!s){O.showWarning(o("common.isFormErrors"));return}C.addRecipe({...a.toJson()}),O.show(o("recipes.page.message.recipeAdded")),await f.push(g.value.recipes.path)}async function it(){const{valid:s}=await H.value.validate();if(!s){O.showWarning(o("common.isFormErrors"));return}C.editRecipe({index:le.value,recipe:a.toJson()}),O.show(o("recipes.page.message.recipeEdited")),await f.push(g.value.recipes.path)}async function ut(){C.removeRecipe(le.value),O.show(o("recipes.page.message.recipeRemoved")),await f.push(g.value.recipes.path)}async function rt(){O.show(o("recipes.page.message.recipeCopied")),await f.push(`${g.value.recipes.path}create/?copy=${le.value}`)}function mt(s){a.setReagentAmount(s,re)}function dt(s,d,I){a.setReagentAmount(s,me);let z=a.reagents.find(Q=>Q.key===I);z?z.amount=d:(z=c.find(Q=>Q.key===I),z.amount=d,a.reagents.push(z))}function ct(s){Ie(s).forEach(([d,I])=>{const z=a.reagents.find(Q=>Q.key===d);z.isLiquid&&a.correctWaterVolumeByReagentAmount(Y(I),z.amount),a.setReagentAmount(Y(I),d)})}return At({title:o("meta.recipe.title")}),(s,d)=>{const I=bt,z=gt,Q=wt,Le=Ot,Ee=ve,pt=pa,ft=Va,yt=Ra,vt=Ma,kt=Ua;return r(),Z(aa,{class:"mb-12"},{default:n(()=>[t(Be,null,{default:n(()=>[t(I,{path:e(g).recipes.path},{default:n(()=>[!e(v)&&!e(X)?(r(),Z(W,{key:0,color:"primary",class:"ml-auto",size:"small",onClick:rt},{default:n(()=>[T(u(e(o)("buttons.copy")),1)]),_:1})):D("",!0)]),_:1},8,["path"]),t(z,null,{default:n(()=>[e(v)&&!e(w)?(r(),V(N,{key:0},[T(u(e(o)("recipes.page.titleNew")),1)],64)):e(w)?(r(),V(N,{key:1},[M("div",Ba,u(e(o)("recipes.page.titleCopy"))+" "+u(e(a).name),1),M("div",$a,u(e(o)("recipes.page.subtitleCopy")),1)],64)):e(X)?(r(),V(N,{key:2},[M("p",Ka,u(e(o)("recipes.page.titleShare")),1),M("p",Fa,u(e(o)("recipes.page.subtitleShare")),1)],64)):(r(),V(N,{key:3},[T(u(e(a).name),1)],64))]),_:1}),t(we,{cols:"12",sm:"10",md:"8","offset-sm":"1","offset-md":"2"},{default:n(()=>[t(fe,{ref_key:"recipeFormRef",ref:H},{default:n(()=>[M("div",Da,u(e(a).isWater?e(o)("recipes.page.reagentsHintWater"):e(o)("recipes.page.reagentsHint")),1),t(Q,{"model-value":e(a).reagents,items:e(c),"item-title":"text",variant:"underlined",multiple:"",label:e(o)("common.reagents"),hint:e(o)("common.comboboxTypingHint"),"persistent-hint":"",chips:"","closable-chips":"","hide-details":"auto",class:"mb-2","onUpdate:modelValue":x},null,8,["model-value","items","label","hint"]),M("div",{class:"d-flex justify-end text-blue cursor-pointer",onClick:d[0]||(d[0]=_=>{oe.value=!0})},u(e(o)("recipes.page.noReagent")),1),t(Q,{modelValue:e(h),"onUpdate:modelValue":[d[1]||(d[1]=_=>E(h)?h.value=_:null),R],items:"FERTILIZER_RECIPES"in s?s.FERTILIZER_RECIPES:e(Fe),"item-title":"name",variant:"underlined",label:e(o)("common.recipes"),hint:e(o)("recipes.page.recipesHint"),"persistent-hint":"","hide-selected":"","hide-details":"auto"},null,8,["modelValue","items","label","hint"]),e(a).isReagents?(r(),V("div",La,[t(Le,{modelValue:e(G),"onUpdate:modelValue":d[2]||(d[2]=_=>E(G)?G.value=_:null),button:"",class:"mt-10 mb-4"},{default:n(()=>[T(u(e(o)("common.reagents")),1)]),_:1},8,["modelValue"]),t(ie,null,{default:n(()=>[e(G)?(r(),V("div",Wa,[(r(!0),V(N,null,J(e(a).reagents,_=>(r(),V("div",{key:_.key,class:"d-flex flex-column flex-sm-row justify-space-between align-sm-center text-body-1 mb-2 mb-sm-0 text-body-2"},[M("div",null,u(_.text),1),M("div",null,u(_.percent),1)]))),128)),M("div",za,u(e(o)("recipes.page.reagentsDescription")),1)])):D("",!0)]),_:1})])):D("",!0),t(ie,null,{default:n(()=>[e(a).isReagents?(r(),V("div",ja,[(r(!0),V(N,null,J(e(a).reagents,_=>(r(),V("div",{key:_.key,class:"d-flex align-center mb-2"},[t(Ee,{"model-value":_.amount,label:_.text,suffix:_.isLiquid?e(o)("units.ml"):e(o)("units.g"),"hide-details":"auto",rules:[e(q),e(l)],error:nt(_),"error-messages":lt(_),"onUpdate:modelValue":pe=>F(pe,_)},Nt({_:2},[_.key===("TrilonB"in s?s.TrilonB:e(re))?{name:"append",fn:n(()=>[t(W,{color:"primary",size:"small",onClick:d[3]||(d[3]=pe=>{be.value=!0})},{default:n(()=>[T(u(e(o)("buttons.calculate")),1)]),_:1})]),key:"0"}:_.key===("EDTA"in s?s.EDTA:e(me))?{name:"append",fn:n(()=>[t(W,{color:"primary",size:"small",onClick:d[4]||(d[4]=pe=>{ge.value=!0})},{default:n(()=>[T(u(e(o)("buttons.calculate")),1)]),_:1})]),key:"1"}:void 0]),1032,["model-value","label","suffix","rules","error","error-messages","onUpdate:modelValue"]),_.isLiquid&&_.key!==("H2O"in s?s.H2O:e(Oe))&&_.type!==("ReagentTypeName"in s?s.ReagentTypeName:e(ee)).COMPOUND?(r(),V("div",Ga,[t(Ee,{"model-value":_.dilution,label:e(o)("recipes.page.dilution"),suffix:"%",class:"ml-2","hide-details":"auto","onUpdate:modelValue":pe=>S(pe,_)},null,8,["model-value","label","onUpdate:modelValue"])])):D("",!0)]))),128)),e(a).isLiquid?(r(),V("div",Ja,[t(W,{color:"primary",size:"small",onClick:d[5]||(d[5]=_=>{he.value=!0})},{default:n(()=>[T(u(e(o)("recipes.page.calculateReagentMass")),1)]),_:1})])):D("",!0),t(ie,null,{default:n(()=>[e(a).isSeveralLiquidReagents?(r(),V("div",Za,[t(Ee,{"model-value":e(a).totalVolume,label:e(o)("recipes.page.totalVolume"),suffix:e(o)("units.ml"),variant:"outlined",hint:e(a).isSeveralLiquidReagents?e(o)("recipes.page.totalVolumeHint"):"","persistent-hint":"auto",class:"mt-4","onUpdate:modelValue":U},null,8,["model-value","label","suffix","hint"])])):D("",!0)]),_:1})])):D("",!0)]),_:1}),e(a).isNotOnlyWaterReagent?(r(),V("div",Ya,[t(Le,{class:"mt-10 mb-4"},{default:n(()=>[T(u(e(o)("recipes.page.fertilizerConc")),1)]),_:1}),t(pt,{recipe:e(a),class:"mb-10"},null,8,["recipe"]),t(Ve,{modelValue:e(a).name,"onUpdate:modelValue":d[6]||(d[6]=_=>e(a).name=_),variant:"underlined",label:e(o)("recipes.page.name"),hint:e(o)("recipes.page.nameHint"),"hide-details":"auto",class:"mb-2 mb-sm-4",rules:[e(q),ot]},null,8,["modelValue","label","hint","rules"]),t(ia,{modelValue:e(a).description,"onUpdate:modelValue":d[7]||(d[7]=_=>e(a).description=_),variant:"underlined",label:e(o)("recipes.page.description"),"hide-details":"auto","auto-grow":"",rows:"1",hint:e(o)("recipes.page.descriptionHint")},null,8,["modelValue","label","hint"]),M("div",Xa,[!e(v)&&!e(X)?(r(),Z(W,{key:0,color:"error",onClick:ut},{default:n(()=>[T(u(e(o)("buttons.remove")),1)]),_:1})):D("",!0),t(W,{class:"ml-auto",onClick:d[8]||(d[8]=_=>s.$router.push(e(g).recipes.path))},{default:n(()=>[T(u(e(o)("buttons.cancel")),1)]),_:1}),t(W,te({color:"primary",class:"ml-2"},qt(e(v)||e(X)?{click:st}:{click:it})),{default:n(()=>[T(u(e(o)("buttons.save")),1)]),_:1},16)])])):D("",!0)]),_:1},512)]),_:1})]),_:1}),t(ft,{modelValue:e(oe),"onUpdate:modelValue":d[9]||(d[9]=_=>E(oe)?oe.value=_:null)},null,8,["modelValue"]),t(yt,{modelValue:e(be),"onUpdate:modelValue":d[10]||(d[10]=_=>E(be)?be.value=_:null),recipe:e(a),onSave:mt},null,8,["modelValue","recipe"]),t(vt,{modelValue:e(ge),"onUpdate:modelValue":d[11]||(d[11]=_=>E(ge)?ge.value=_:null),recipe:e(a),onSave:dt},null,8,["modelValue","recipe"]),t(kt,{modelValue:e(he),"onUpdate:modelValue":d[12]||(d[12]=_=>E(he)?he.value=_:null),recipe:e(a),onSave:ct},null,8,["modelValue","recipe"])]),_:1})}}}),Qo=Et(Qa,[["__scopeId","data-v-b0d87f59"]]);export{Qo as default};
